(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"0qSw":function(t,o,e){"use strict";e.r(o),e.d(o,"CouriersPageModule",(function(){return wt}));var i=e("mrSG");class r{constructor(t){this.optionId=((new Date).getTime()/1e3|0).toString(16)+"xxxxxxxxxxxxxxxx".replace(/[x]/g,()=>(16*Math.random()|0).toString(16)).toLowerCase(),void 0!==t&&null!=t&&(void 0!==t.type&&null!=t.type&&(this.type=t.type),void 0!==t.price&&null!=t.price&&(this.price=t.price),void 0!==t.optionId&&null!=t.optionId&&(this.optionId=t.optionId))}}class n{constructor(t){this.options=[],void 0!==t&&null!=t&&(void 0!==t.role&&null!=t.role&&(this.role=t.role),void 0!==t.icon&&null!=t.icon&&(this.icon=t.icon),void 0!==t.phone&&null!=t.phone&&(this.phone=t.phone),void 0!==t.email&&null!=t.email&&(this.email=t.email),void 0!==t.storeId&&null!=t.storeId&&(this.storeId=t.storeId),void 0!==t.options&&null!=t.options&&(this.options=t.options.map(t=>new r(t))),void 0!==t.account&&null!=t.account&&(this.account=t.account),void 0!==t.courierId&&null!=t.courierId&&(this.courierId=t.courierId),void 0!==t.description&&null!=t.description&&(this.description=t.description))}}var s=e("Dh3D"),c=e("+0xr"),a=e("fXoL"),l=e("9ZKQ"),d=e("u0tM"),u=e("swrf"),b=e("tyNb"),m=e("vmqu"),p=e("BhS5"),h=e("WF9o"),f=e("4jEk"),g=e("ofXK"),v=e("bv9b"),S=e("bTqV"),w=e("NFeN");function R(t,o){1&t&&a.Nb(0,"mat-progress-bar",9)}function C(t,o){1&t&&(a.Sb(0,"th",10),a.Cc(1," Description "),a.Rb())}function I(t,o){if(1&t&&(a.Sb(0,"td",11),a.Cc(1),a.Rb()),2&t){const t=o.$implicit;a.Ab(1),a.Ec(" ",t.description," ")}}function A(t,o){1&t&&a.Nb(0,"th",12)}function k(t,o){if(1&t){const t=a.Tb();a.Sb(0,"td",11),a.Sb(1,"button",13),a.ac("click",(function(){a.rc(t);const e=o.$implicit;return a.ec().options(e)})),a.Sb(2,"mat-icon"),a.Cc(3," more_vert "),a.Rb(),a.Rb(),a.Rb()}}function y(t,o){1&t&&a.Nb(0,"tr",14)}function D(t,o){1&t&&a.Nb(0,"tr",15)}let x=(()=>{class t{constructor(t,o,e,i,r,n,s){this.toast=t,this.sheet=o,this.confirm=e,this.router=i,this.service=r,this.buttons=n,this.localstorage=s,this.columns=["description","options"],this.couriers=new c.o,this.subscriptions={}}list(){return Object(i.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.list({sort:{description:1},filter:["role","courierId","description"]});this.couriers.data=t.ok?t.result.map(t=>new n(t)):[],this.loading=!1}))}options(t){return Object(i.a)(this,void 0,void 0,(function*(){this.sheet.show({role:t.role,title:t.description,options:[{icon:"edit",title:"Edit Courier",handler:()=>{this.router.navigate(["/couriers","editor"],{queryParams:{mode:"update",courierId:t.courierId}})},disabled:[0,1]},{icon:"delete",title:"Delete",danger:!0,handler:()=>{this.confirm.show({message:"Delete "+t.description,handler:()=>Object(i.a)(this,void 0,void 0,(function*(){this.loading=!0;const o=yield this.service.delete({courierId:t.courierId});if(o.ok){for(let o=0;o<this.couriers.data.length;o++)if(this.couriers.data[o].courierId==t.courierId){this.couriers.data.splice(o,1);break}this.couriers.data=this.couriers.data.map(t=>new n(t)),this.toast.success("Courier was removed!")}else this.toast.error(o.error.message);this.loading=!1}))})},disabled:[0,1,2,3,4]}]})}))}ngOnInit(){this.buttons.show("add"),this.buttons.hide("close"),this.buttons.hide("filter"),this.buttons.hide("search"),this.sort.active="description",this.sort.direction="desc",this.couriers.sort=this.sort,this.subscriptions.add=this.buttons.add.click.subscribe(t=>{this.router.navigate(["/couriers","editor"],{queryParams:{mode:"add"}})}),this.list()}ngOnDestroy(){this.subscriptions.add.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(a.Mb(l.a),a.Mb(d.a),a.Mb(u.a),a.Mb(b.b),a.Mb(m.a),a.Mb(p.a),a.Mb(h.a))},t.\u0275cmp=a.Gb({type:t,selectors:[["couriers-page"]],viewQuery:function(t,o){var e;1&t&&a.wc(s.a,!0),2&t&&a.oc(e=a.bc())&&(o.sort=e.first)},decls:11,vars:5,consts:[["mode","indeterminate",4,"ngIf"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","description"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,o){1&t&&(a.Sb(0,"mat-content"),a.Ac(1,R,1,0,"mat-progress-bar",0),a.Sb(2,"table",1),a.Qb(3,2),a.Ac(4,C,2,0,"th",3),a.Ac(5,I,2,1,"td",4),a.Pb(),a.Qb(6,5),a.Ac(7,A,1,0,"th",6),a.Ac(8,k,4,0,"td",4),a.Pb(),a.Ac(9,y,1,0,"tr",7),a.Ac(10,D,1,0,"tr",8),a.Rb(),a.Rb()),2&t&&(a.Ab(1),a.kc("ngIf",o.loading),a.Ab(1),a.kc("dataSource",o.couriers),a.Ab(7),a.kc("matHeaderRowDef",o.columns)("matHeaderRowDefSticky",!0),a.Ab(1),a.kc("matRowDefColumns",o.columns))},directives:[f.a,g.m,c.n,s.a,c.c,c.i,c.b,c.k,c.m,v.a,c.h,s.b,c.a,S.a,w.a,c.j,c.l],styles:[""]}),t})();var M=e("o3Q1"),q=e("3Pt+"),N=e("btHx"),O=e("dWDE"),E=e("in+p"),P=e("FKr1"),j=e("kmnG"),F=e("d3UM"),G=e("WJ5W"),H=e("qFsG"),T=e("ZRfb"),V=e("AbOq"),Q=e("roMP");function $(t,o){1&t&&a.Nb(0,"mat-progress-bar",28)}function W(t,o){if(1&t&&(a.Sb(0,"mat-option",29),a.Cc(1),a.Rb()),2&t){const t=o.$implicit;a.kc("value",t.storeId)("disabled",t.role<2),a.Ab(1),a.Ec(" ",t.description," ")}}function J(t,o){if(1&t&&(a.Sb(0,"mat-error"),a.Cc(1),a.Rb()),2&t){const t=a.ec();a.Ab(1),a.Ec(" ",t.errors.storeId," ")}}function K(t,o){if(1&t&&(a.Sb(0,"mat-error"),a.Cc(1),a.Rb()),2&t){const t=a.ec();a.Ab(1),a.Ec(" ",t.errors.email," ")}}function L(t,o){if(1&t&&(a.Sb(0,"mat-error"),a.Cc(1),a.Rb()),2&t){const t=a.ec();a.Ab(1),a.Ec(" ",t.errors.phone," ")}}function Z(t,o){if(1&t&&(a.Sb(0,"mat-error"),a.Cc(1),a.Rb()),2&t){const t=a.ec();a.Ab(1),a.Ec(" ",t.errors.account," ")}}function B(t,o){if(1&t&&(a.Sb(0,"mat-error"),a.Cc(1),a.Rb()),2&t){const t=a.ec();a.Ab(1),a.Ec(" ",t.errors.description," ")}}function _(t,o){1&t&&(a.Sb(0,"th",30),a.Cc(1," Type "),a.Rb())}const z=function(){return{standalone:!0}};function U(t,o){if(1&t){const t=a.Tb();a.Sb(0,"td",31),a.Sb(1,"mat-select",32),a.ac("ngModelChange",(function(e){return a.rc(t),o.$implicit.type=e})),a.Sb(2,"mat-option",33),a.Cc(3," Express "),a.Rb(),a.Sb(4,"mat-option",34),a.Cc(5," Ex Works "),a.Rb(),a.Sb(6,"mat-option",35),a.Cc(7," Standard "),a.Rb(),a.Rb(),a.Rb()}if(2&t){const t=o.$implicit;a.Ab(1),a.kc("ngModel",t.type)("ngModelOptions",a.lc(2,z))}}function X(t,o){if(1&t&&(a.Sb(0,"td",36),a.Sb(1,"mat-select",37),a.Sb(2,"mat-option",33),a.Cc(3," Express "),a.Rb(),a.Sb(4,"mat-option",34),a.Cc(5," Ex Works "),a.Rb(),a.Sb(6,"mat-option",35),a.Cc(7," Standard "),a.Rb(),a.Rb(),a.Rb()),2&t){const t=a.ec();a.kc("formGroup",t.option)}}function Y(t,o){1&t&&(a.Sb(0,"th",30),a.Cc(1," Price "),a.Rb())}function tt(t,o){if(1&t){const t=a.Tb();a.Sb(0,"td",31),a.Sb(1,"input",38),a.ac("ngModelChange",(function(e){return a.rc(t),o.$implicit.price=e})),a.Rb(),a.Rb()}if(2&t){const t=o.$implicit;a.Ab(1),a.kc("ngModel",t.price)("ngModelOptions",a.lc(2,z))}}function ot(t,o){if(1&t&&(a.Sb(0,"td",36),a.Nb(1,"input",39),a.Rb()),2&t){const t=a.ec();a.kc("formGroup",t.option)}}function et(t,o){1&t&&a.Nb(0,"th",30)}function it(t,o){if(1&t){const t=a.Tb();a.Sb(0,"td",31),a.Sb(1,"button",40),a.ac("click",(function(){a.rc(t);const e=o.$implicit;return a.ec().remove(e)})),a.Sb(2,"mat-icon"),a.Cc(3," delete "),a.Rb(),a.Rb(),a.Rb()}}function rt(t,o){if(1&t){const t=a.Tb();a.Sb(0,"td",41),a.Sb(1,"button",42),a.ac("click",(function(){return a.rc(t),a.ec().add()})),a.Sb(2,"mat-icon"),a.Cc(3," add "),a.Rb(),a.Rb(),a.Rb()}if(2&t){const t=a.ec();a.Ab(1),a.kc("disabled",t.option.invalid)}}function nt(t,o){1&t&&a.Nb(0,"tr",43)}function st(t,o){1&t&&a.Nb(0,"tr",44)}function ct(t,o){1&t&&a.Nb(0,"tr",45)}const at=function(t){return{description:t}};let lt=(()=>{class t{constructor(t,o,e,i,r,s,a){this.toast=t,this.route=o,this.stores=e,this.router=i,this.service=r,this.buttons=s,this.formerror=a,this.form=new q.f({icon:new q.c(null,[q.t.required]),phone:new q.c(null,[q.t.required]),email:new q.c(null,[q.t.required]),storeId:new q.c(null,[q.t.required]),account:new q.c(null,[q.t.required]),description:new q.c(null,[q.t.required])}),this.errors={icon:"",phone:"",email:"",storeId:"",account:"",description:""},this.filter=new q.f({store:new q.c(null,[q.t.required])}),this.option=new q.f({type:new q.c(null,[q.t.required]),price:new q.c(null,[q.t.required,q.t.min(0)])}),this.columns=["type","price","options"],this.options=new c.o,this.courier=new n,this.subscriptions={}}add(){return Object(i.a)(this,void 0,void 0,(function*(){this.options.data.push(new r(this.option.value)),this.options.data=this.options.data.map(t=>new r(t)),this.option.reset(),this.option.markAsUntouched()}))}get(){return Object(i.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.get({filter:["role","icon","phone","email","storeId","options","account","description"],courierId:this.courierId});t.ok?(this.courier=new n(t.result),this.courier.role>2?(this.options.data=this.courier.options,this.form.controls.icon.setValue(this.courier.icon),this.form.controls.phone.setValue(this.courier.phone),this.form.controls.email.setValue(this.courier.email),this.form.controls.storeId.setValue(this.courier.storeId),this.form.controls.account.setValue(this.courier.account),this.form.controls.description.setValue(this.courier.description)):(this.toast.error("Your role is not high enough to copy/edit this courier!"),this.router.navigate(["/couriers"]))):(this.toast.error(t.error.message),this.router.navigate(["/couriers"])),this.loading=!1}))}load(){return Object(i.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.stores.list({sort:{description:1},filter:["storeId","description"]});t.ok?this.stores.data=t.result.map(t=>new M.a(t)):(this.stores.data=[],this.toast.error(t.error.message)),this.loading=!1}))}submit(){return Object(i.a)(this,void 0,void 0,(function*(){this.loading=!0;let t=this.mode;"copy"==t&&(t="add",delete this.courierId);const o=yield this.service[t]({icon:this.form.value.icon,phone:this.form.value.phone,email:this.form.value.email,options:this.options.data,storeId:this.form.value.storeId,account:this.form.value.account,courierId:this.courierId,description:this.form.value.description});o.ok?this.router.navigate(["/couriers"]):this.toast.error(o.error.message),this.loading=!1}))}upload(t,o){this.form.controls[t].setValue(o)}remove(t){return Object(i.a)(this,void 0,void 0,(function*(){for(let o=0;o<this.options.data.length;o++)if(this.options.data[o].optionId==t.optionId){this.options.data.splice(o,1);break}this.options.data=this.options.data.map(t=>new r(t))}))}ngOnInit(){this.buttons.hide("add"),this.buttons.show("close"),this.buttons.hide("filter"),this.buttons.hide("search"),this.subscriptions.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.subscriptions.close=this.buttons.close.click.subscribe(t=>{this.router.navigate(["/couriers"])});const t=this.route.snapshot.queryParams;this.mode=t.mode,this.courierId=t.courierId,(()=>{Object(i.a)(this,void 0,void 0,(function*(){"add"!=this.mode&&(yield this.get()),yield this.load()}))})()}ngOnDestroy(){this.subscriptions.form.unsubscribe(),this.subscriptions.close.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(a.Mb(l.a),a.Mb(b.a),a.Mb(N.a),a.Mb(b.b),a.Mb(m.a),a.Mb(p.a),a.Mb(O.a))},t.\u0275cmp=a.Gb({type:t,selectors:[["couriers-editor-page"]],decls:58,vars:22,consts:[["mode","indeterminate",4,"ngIf"],[1,"container"],["upload","","matRipple","",1,"logo",3,"upload-src","upload-change"],[3,"formGroup","ngSubmit"],["appearance","outline"],["name","storeId","formControlName","storeId","required",""],[3,"formGroup"],["placeholderLabel","filter stores","noEntriesFoundLabel","no stores found","formControlName","store"],[3,"value","disabled",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","type","email","name","email","placeholder","email","formControlName","email","required",""],["matInput","","type","tel","name","phone","placeholder","phone","formControlName","phone","required",""],["matInput","","type","text","name","account","placeholder","account","formControlName","account","required",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],["mat-table","",3,"dataSource"],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",3,"formGroup",4,"matFooterCellDef"],["matColumnDef","price"],["matColumnDef","options"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["type","submit",2,"display","none"],["button",""],["type","button","color","primary","mat-flat-button","",3,"click"],["mode","indeterminate"],[3,"value","disabled"],["mat-header-cell",""],["mat-cell",""],["placeholder","type","required","",3,"ngModel","ngModelOptions","ngModelChange"],["value","express"],["value","exworks"],["value","standard"],["mat-footer-cell","",3,"formGroup"],["formControlName","type","placeholder","type","required",""],["matInput","","min","0","type","number","placeholder","price","required","",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","min","0","type","number","placeholder","price","formControlName","price","required",""],["type","button","color","warn","mat-icon-button","",3,"click"],["mat-footer-cell",""],["type","button","color","primary","mat-icon-button","",3,"disabled","click"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""]],template:function(t,o){if(1&t){const t=a.Tb();a.Sb(0,"mat-content"),a.Ac(1,$,1,0,"mat-progress-bar",0),a.Sb(2,"div",1),a.Sb(3,"div",2),a.ac("upload-change",(function(t){return o.upload("icon",t)})),a.Sb(4,"mat-icon"),a.Cc(5," upload "),a.Rb(),a.Rb(),a.Sb(6,"form",3),a.ac("ngSubmit",(function(){return!o.form.invalid&&!o.loading&&o.submit()})),a.Sb(7,"mat-form-field",4),a.Sb(8,"mat-label"),a.Cc(9," Store "),a.Rb(),a.Sb(10,"mat-select",5),a.Sb(11,"mat-option",6),a.Nb(12,"ngx-mat-select-search",7),a.Rb(),a.Ac(13,W,2,3,"mat-option",8),a.fc(14,"filterBy"),a.fc(15,"orderBy"),a.Rb(),a.Ac(16,J,2,1,"mat-error",9),a.Rb(),a.Sb(17,"mat-form-field",4),a.Sb(18,"mat-label"),a.Cc(19," Email "),a.Rb(),a.Nb(20,"input",10),a.Ac(21,K,2,1,"mat-error",9),a.Rb(),a.Sb(22,"mat-form-field",4),a.Sb(23,"mat-label"),a.Cc(24," Phone "),a.Rb(),a.Nb(25,"input",11),a.Ac(26,L,2,1,"mat-error",9),a.Rb(),a.Sb(27,"mat-form-field",4),a.Sb(28,"mat-label"),a.Cc(29," Account "),a.Rb(),a.Nb(30,"input",12),a.Ac(31,Z,2,1,"mat-error",9),a.Rb(),a.Sb(32,"mat-form-field",4),a.Sb(33,"mat-label"),a.Cc(34," Description "),a.Rb(),a.Nb(35,"input",13),a.Ac(36,B,2,1,"mat-error",9),a.Rb(),a.Sb(37,"table",14),a.Qb(38,15),a.Ac(39,_,2,0,"th",16),a.Ac(40,U,8,3,"td",17),a.Ac(41,X,8,1,"td",18),a.Pb(),a.Qb(42,19),a.Ac(43,Y,2,0,"th",16),a.Ac(44,tt,2,3,"td",17),a.Ac(45,ot,2,1,"td",18),a.Pb(),a.Qb(46,20),a.Ac(47,et,1,0,"th",16),a.Ac(48,it,4,0,"td",17),a.Ac(49,rt,4,1,"td",21),a.Pb(),a.Ac(50,nt,1,0,"tr",22),a.Ac(51,st,1,0,"tr",23),a.Ac(52,ct,1,0,"tr",24),a.Rb(),a.Nb(53,"button",25,26),a.Rb(),a.Rb(),a.Rb(),a.Sb(55,"mat-footer"),a.Sb(56,"button",27),a.ac("click",(function(){return a.rc(t),a.pc(54).click()})),a.Cc(57," submit "),a.Rb(),a.Rb()}2&t&&(a.Ab(1),a.kc("ngIf",o.loading),a.Ab(2),a.kc("upload-src",o.form.value.icon),a.Ab(3),a.kc("formGroup",o.form),a.Ab(5),a.kc("formGroup",o.filter),a.Ab(2),a.kc("ngForOf",a.hc(14,14,a.hc(15,17,o.stores.data,"description"),a.mc(20,at,o.filter.value.store))),a.Ab(3),a.kc("ngIf",o.errors.storeId),a.Ab(5),a.kc("ngIf",o.errors.email),a.Ab(5),a.kc("ngIf",o.errors.phone),a.Ab(5),a.kc("ngIf",o.errors.account),a.Ab(5),a.kc("ngIf",o.errors.description),a.Ab(1),a.kc("dataSource",o.options),a.Ab(13),a.kc("matHeaderRowDef",o.columns),a.Ab(1),a.kc("matRowDefColumns",o.columns),a.Ab(1),a.kc("matFooterRowDef",o.columns))},directives:[f.a,g.m,E.a,P.o,w.a,q.u,q.n,q.g,j.c,j.f,F.a,q.m,q.e,q.s,P.k,G.a,g.l,H.a,q.b,c.n,c.c,c.i,c.b,c.e,c.k,c.m,c.g,T.a,S.a,v.a,j.b,c.h,c.a,q.p,c.d,q.q,c.j,c.l,c.f],pipes:[V.a,Q.a],styles:[".logo[_ngcontent-%COMP%]{width:150px;height:150px;border:1px solid #e0e0e0;display:flex;margin:20px auto auto;align-items:center;border-radius:5px;justify-content:center;background-color:#fafafa}.mat-column-price[_ngcontent-%COMP%]{padding-left:16px!important}"]}),t})();var dt=e("5Yg0"),ut=e("gyTc"),bt=e("R32p"),mt=e("A5z7"),pt=e("tVzd"),ht=e("J89Z"),ft=e("p/0r"),gt=e("H0Zp"),vt=e("bSwM");const St=[{path:"",component:x},{path:"editor",component:lt}];let wt=(()=>{class t{}return t.\u0275mod=a.Kb({type:t}),t.\u0275inj=a.Jb({factory:function(o){return new(o||t)},imports:[[q.i,g.c,dt.a,bt.a,s.c,s.c,ut.a,w.b,c.p,mt.e,H.b,P.p,S.b,F.b,pt.a,ht.a,ft.a,gt.a,vt.b,j.e,q.r,v.b,G.b,b.e.forChild(St)]]}),t})()}}]);