(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{b5pT:function(t,e,i){"use strict";i.r(e),i.d(e,"ReviewsPageModule",(function(){return bt}));var s=i("mrSG"),o=i("o3Q1");class r{constructor(t){this.store={description:null},this.product={title:null},void 0!==t&&null!=t&&(void 0!==t.store&&null!=t.store&&void 0!==t.store.description&&null!=t.store.description&&(this.store.description=t.store.description),void 0!==t.product&&null!=t.product&&void 0!==t.product.title&&null!=t.product.title&&(this.product.title=t.product.title),void 0!==t.role&&null!=t.role&&(this.role=t.role),void 0!==t.role&&null!=t.role&&(this.role=t.role),void 0!==t.score&&null!=t.score&&(this.score=t.score),void 0!==t.status&&null!=t.status&&(this.status=t.status),void 0!==t.storeId&&null!=t.storeId&&(this.storeId=t.storeId),void 0!==t.message&&null!=t.message&&(this.message=t.message),void 0!==t.reviewId&&null!=t.reviewId&&(this.reviewId=t.reviewId),void 0!==t.productId&&null!=t.productId&&(this.productId=t.productId))}}var c=i("Dh3D"),n=i("+0xr"),a=i("3Pt+"),l=i("0IaG"),d=i("fXoL"),b=i("btHx"),u=i("dWDE"),f=i("/t3+"),m=i("kmnG"),h=i("bTqV"),p=i("NFeN"),v=i("4jEk"),g=i("d3UM"),w=i("FKr1"),R=i("WJ5W"),C=i("ofXK"),S=i("AbOq"),I=i("roMP");function A(t,e){if(1&t&&(d.Sb(0,"mat-option",10),d.Cc(1),d.Rb()),2&t){const t=e.$implicit;d.kc("value",t.storeId),d.Ab(1),d.Ec(" ",t.description," ")}}function k(t,e){if(1&t&&(d.Sb(0,"mat-error"),d.Cc(1),d.Rb()),2&t){const t=d.ec();d.Ab(1),d.Ec(" ",t.errors.storeId," ")}}const x=function(t){return{description:t}};let y=(()=>{class t{constructor(t,e,i,s){this.dialog=t,this.config=e,this.stores=i,this.formerror=s,this.form=new a.f({storeId:new a.c([])}),this.filter=new a.f({store:new a.c("")}),this.errors={storeId:""},this.subscriptions={}}load(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.stores.list({filter:["storeId","description"]});this.stores.data=t.ok?t.result.map(t=>new o.a(t)):[],void 0!==this.config.storeId&&null!=this.config.storeId&&this.form.controls.storeId.setValue(this.config.storeId),this.loading=!1}))}close(){return Object(s.a)(this,void 0,void 0,(function*(){this.dialog.close(!1)}))}submit(){return Object(s.a)(this,void 0,void 0,(function*(){this.dialog.close(this.form.value)}))}ngOnInit(){this.subscriptions.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.load()}ngOnDestroy(){this.subscriptions.form.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(l.d),d.Mb(l.a),d.Mb(b.a),d.Mb(u.a))},t.\u0275cmp=d.Gb({type:t,selectors:[["reviews-filter-dialog"]],decls:20,vars:12,consts:[[1,"spacer"],["mat-icon-button","",3,"click"],[3,"formGroup","ngSubmit"],["appearance","outline"],["name","storeId","formControlName","storeId","multiple",""],[3,"formGroup"],["placeholderLabel","filter stores","noEntriesFoundLabel","no stores found","formControlName","store"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","submit","color","primary","mat-flat-button",""],[3,"value"]],template:function(t,e){1&t&&(d.Sb(0,"mat-toolbar"),d.Sb(1,"mat-label",0),d.Cc(2," Filter Reviews "),d.Rb(),d.Sb(3,"button",1),d.ac("click",(function(){return e.close()})),d.Sb(4,"mat-icon"),d.Cc(5," close "),d.Rb(),d.Rb(),d.Rb(),d.Sb(6,"mat-content"),d.Sb(7,"form",2),d.ac("ngSubmit",(function(){return!e.loading&&!e.form.invalid&&e.submit()})),d.Sb(8,"mat-form-field",3),d.Sb(9,"mat-label"),d.Cc(10," Store(s) "),d.Rb(),d.Sb(11,"mat-select",4),d.Sb(12,"mat-option",5),d.Nb(13,"ngx-mat-select-search",6),d.Rb(),d.Ac(14,A,2,2,"mat-option",7),d.fc(15,"filterBy"),d.fc(16,"orderBy"),d.Rb(),d.Ac(17,k,2,1,"mat-error",8),d.Rb(),d.Sb(18,"button",9),d.Cc(19," submit "),d.Rb(),d.Rb(),d.Rb()),2&t&&(d.Ab(7),d.kc("formGroup",e.form),d.Ab(5),d.kc("formGroup",e.filter),d.Ab(2),d.kc("ngForOf",d.hc(15,4,d.hc(16,7,e.stores.data,"description"),d.mc(10,x,e.filter.value.store))),d.Ab(3),d.kc("ngIf",e.errors.storeId))},directives:[f.a,m.f,h.a,p.a,v.a,a.u,a.n,a.g,m.c,g.a,a.m,a.e,w.k,R.a,C.l,C.m,m.b],pipes:[S.a,I.a],styles:[".filter-dialog{width:500px!important}.filter-dialog .mat-dialog-container{padding:0!important}@media screen and (max-width:600px){.filter-dialog .mat-dialog-container{top:0;left:0;right:0;bottom:0;z-index:5000;position:fixed;border-radius:0}}"],encapsulation:2}),t})();var O=i("u0tM"),z=i("9ZKQ"),M=i("bS1C"),j=i("IwJj"),D=i("BhS5"),P=i("bv9b"),E=i("A5z7");let _=(()=>{class t{constructor(){this.size=16,this.value=0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Gb({type:t,selectors:[["mat-stars"]],inputs:{size:"size",value:"value"},decls:10,vars:40,template:function(t,e){1&t&&(d.Sb(0,"mat-icon"),d.Cc(1,"star"),d.Rb(),d.Sb(2,"mat-icon"),d.Cc(3,"star"),d.Rb(),d.Sb(4,"mat-icon"),d.Cc(5,"star"),d.Rb(),d.Sb(6,"mat-icon"),d.Cc(7,"star"),d.Rb(),d.Sb(8,"mat-icon"),d.Cc(9,"star"),d.Rb()),2&t&&(d.xc("width",e.size,"px")("height",e.size,"px")("font-size",e.size,"px"),d.Eb("active",e.value>=1),d.Ab(2),d.xc("width",e.size,"px")("height",e.size,"px")("font-size",e.size,"px"),d.Eb("active",e.value>=2),d.Ab(2),d.xc("width",e.size,"px")("height",e.size,"px")("font-size",e.size,"px"),d.Eb("active",e.value>=3),d.Ab(2),d.xc("width",e.size,"px")("height",e.size,"px")("font-size",e.size,"px"),d.Eb("active",e.value>=4),d.Ab(2),d.xc("width",e.size,"px")("height",e.size,"px")("font-size",e.size,"px"),d.Eb("active",e.value>=5))},directives:[p.a],styles:["mat-stars{display:flex;flex-direction:row}mat-stars mat-icon{color:#e0e0e0}mat-stars mat-icon.active{color:#ffc107}"],encapsulation:2}),t})();function F(t,e){1&t&&d.Nb(0,"mat-progress-bar",14)}function G(t,e){if(1&t){const t=d.Tb();d.Sb(0,"mat-chip",17),d.ac("removed",(function(){d.rc(t);const i=e.$implicit;return d.ec(2).unfilter("storeId",i)})),d.Sb(1,"mat-icon"),d.Cc(2," store "),d.Rb(),d.Sb(3,"mat-label"),d.Cc(4),d.Rb(),d.Sb(5,"mat-icon",18),d.Cc(6," cancel "),d.Rb(),d.Rb()}if(2&t){const t=e.$implicit,i=d.ec(2);d.Ab(4),d.Ec(" ",i.describe(i.stores.data,"storeId",t)," ")}}function N(t,e){if(1&t&&(d.Sb(0,"mat-chip-list",15),d.Ac(1,G,7,1,"mat-chip",16),d.Rb()),2&t){const t=d.ec();d.Ab(1),d.kc("ngForOf",t.filter.storeId)}}function Q(t,e){1&t&&(d.Sb(0,"th",19),d.Cc(1," Store "),d.Rb())}function $(t,e){if(1&t&&(d.Sb(0,"td",20),d.Cc(1),d.Rb()),2&t){const t=e.$implicit;d.Ab(1),d.Ec(" ",t.store.description," ")}}function H(t,e){1&t&&(d.Sb(0,"th",19),d.Cc(1," Product "),d.Rb())}function J(t,e){if(1&t&&(d.Sb(0,"td",20),d.Cc(1),d.Rb()),2&t){const t=e.$implicit;d.Ab(1),d.Ec(" ",t.product.title," ")}}function K(t,e){1&t&&(d.Sb(0,"th",19),d.Cc(1," Message "),d.Rb())}function T(t,e){if(1&t&&(d.Sb(0,"td",20),d.Cc(1),d.Rb()),2&t){const t=e.$implicit;d.Ab(1),d.Ec(" ",t.message," ")}}function q(t,e){1&t&&(d.Sb(0,"th",19),d.Cc(1," Score "),d.Rb())}function B(t,e){if(1&t&&(d.Sb(0,"td",20),d.Nb(1,"mat-stars",21),d.Rb()),2&t){const t=e.$implicit;d.Ab(1),d.kc("value",t.score)}}function L(t,e){1&t&&(d.Sb(0,"th",19),d.Cc(1," Status "),d.Rb())}function V(t,e){if(1&t&&(d.Sb(0,"td",20),d.Sb(1,"span"),d.Cc(2),d.Rb(),d.Rb()),2&t){const t=e.$implicit;d.Ab(1),d.Eb("pending","pending approval"==t.status)("rejected","rejected"==t.status)("approved","approved"==t.status),d.Ab(1),d.Ec(" ",t.status," ")}}function W(t,e){1&t&&d.Nb(0,"th",22)}function Z(t,e){if(1&t){const t=d.Tb();d.Sb(0,"td",20),d.Sb(1,"button",23),d.ac("click",(function(){d.rc(t);const i=e.$implicit;return d.ec().options(i)})),d.Sb(2,"mat-icon"),d.Cc(3," more_vert "),d.Rb(),d.Rb(),d.Rb()}}function X(t,e){1&t&&d.Nb(0,"tr",24)}function U(t,e){1&t&&d.Nb(0,"tr",25)}let Y=(()=>{class t{constructor(t,e,i,s,o,r,c){this.sheet=t,this.dialog=e,this.toast=i,this.stores=s,this.filters=o,this.service=r,this.buttons=c,this.filter=this.filters.get({storeId:[]}),this.columns=["store.description","product.title","message","score","status","options"],this.reviews=new n.o,this.subscriptions={}}list(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.list({sort:{description:1},filter:["role","store","score","status","message","product","reviewId"],storeId:this.filter.storeId});this.reviews.data=t.ok?t.result.map(t=>new r(t)):[],this.loading=!1}))}load(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.stores.list({filter:["storeId","description"]});this.stores.data=t.ok?t.result.map(t=>new o.a(t)):[],this.loading=!1}))}unfilter(t,e){this.filter[t]=this.filter[t].filter(t=>t!=e),this.filters.update(this.filter),this.list()}options(t){return Object(s.a)(this,void 0,void 0,(function*(){this.sheet.show({role:t.role,title:t.message,options:[{icon:"thumb_up_alt",title:"Approve Review",handler:()=>Object(s.a)(this,void 0,void 0,(function*(){const e=yield this.service.approve({reviewId:t.reviewId});if(e.ok){for(let e=0;e<this.reviews.data.length;e++)if(this.reviews.data[e].reviewId==t.reviewId){this.reviews.data[e].status="approved";break}this.toast.success("Review was approved!")}else this.toast.error(e.error.message)})),disabled:[0,1]},{icon:"thumb_down_alt",title:"Reject Review",handler:()=>Object(s.a)(this,void 0,void 0,(function*(){const e=yield this.service.reject({reviewId:t.reviewId});if(e.ok){for(let e=0;e<this.reviews.data.length;e++)if(this.reviews.data[e].reviewId==t.reviewId){this.reviews.data[e].status="rejected";break}this.toast.success("Review was rejected!")}else this.toast.error(e.error.message)})),disabled:[0,1]}]})}))}describe(t,e,i){let s="-";return t.map(t=>{t[e]==i&&(s=t.description)}),s}ngOnInit(){this.buttons.hide("add"),this.buttons.hide("close"),this.buttons.show("filter"),this.buttons.hide("search"),this.sort.active="message",this.sort.direction="desc",this.reviews.sort=this.sort,this.subscriptions.filter=this.buttons.filter.click.subscribe(t=>Object(s.a)(this,void 0,void 0,(function*(){const t=yield this.dialog.open(y,{data:this.filter,panelClass:"filter-dialog"});yield t.afterClosed().subscribe(t=>Object(s.a)(this,void 0,void 0,(function*(){t&&(Object.keys(t).map(e=>{this.filter[e]=t[e]}),this.filters.update(this.filter),this.list())})))}))),(()=>{Object(s.a)(this,void 0,void 0,(function*(){yield this.list(),yield this.load()}))})()}ngOnDestroy(){this.subscriptions.filter.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(O.a),d.Mb(l.b),d.Mb(z.a),d.Mb(b.a),d.Mb(M.a),d.Mb(j.a),d.Mb(D.a))},t.\u0275cmp=d.Gb({type:t,selectors:[["reviews-page"]],viewQuery:function(t,e){var i;1&t&&d.wc(c.a,!0),2&t&&d.oc(i=d.bc())&&(e.sort=i.first)},decls:24,vars:6,consts:[["mode","indeterminate",4,"ngIf"],["class","filterbar",4,"ngIf"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","store.description"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","product.title"],["matColumnDef","message"],["matColumnDef","score"],["matColumnDef","status"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mode","indeterminate"],[1,"filterbar"],[3,"removed",4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove",""],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["size","18",3,"value"],["mat-header-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(d.Sb(0,"mat-content"),d.Ac(1,F,1,0,"mat-progress-bar",0),d.Ac(2,N,2,1,"mat-chip-list",1),d.Sb(3,"table",2),d.Qb(4,3),d.Ac(5,Q,2,0,"th",4),d.Ac(6,$,2,1,"td",5),d.Pb(),d.Qb(7,6),d.Ac(8,H,2,0,"th",4),d.Ac(9,J,2,1,"td",5),d.Pb(),d.Qb(10,7),d.Ac(11,K,2,0,"th",4),d.Ac(12,T,2,1,"td",5),d.Pb(),d.Qb(13,8),d.Ac(14,q,2,0,"th",4),d.Ac(15,B,2,1,"td",5),d.Pb(),d.Qb(16,9),d.Ac(17,L,2,0,"th",4),d.Ac(18,V,3,7,"td",5),d.Pb(),d.Qb(19,10),d.Ac(20,W,1,0,"th",11),d.Ac(21,Z,4,0,"td",5),d.Pb(),d.Ac(22,X,1,0,"tr",12),d.Ac(23,U,1,0,"tr",13),d.Rb(),d.Rb()),2&t&&(d.Ab(1),d.kc("ngIf",e.loading),d.Ab(1),d.kc("ngIf",e.filter.storeId.length>0),d.Ab(1),d.kc("dataSource",e.reviews),d.Ab(19),d.kc("matHeaderRowDef",e.columns)("matHeaderRowDefSticky",!0),d.Ab(1),d.kc("matRowDefColumns",e.columns))},directives:[v.a,C.m,n.n,c.a,n.c,n.i,n.b,n.k,n.m,P.a,E.c,C.l,E.a,p.a,m.f,E.d,n.h,c.b,n.a,_,h.a,n.j,n.l],styles:[".mat-column-score[_ngcontent-%COMP%], .mat-column-status[_ngcontent-%COMP%]{width:200px}.mat-column-status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:5px 10px;font-size:12px!important;border-radius:12px;background-color:#e0e0e0}.mat-column-status[_ngcontent-%COMP%]   span.pending[_ngcontent-%COMP%]{color:#fff;background-color:#2196f3}.mat-column-status[_ngcontent-%COMP%]   span.rejected[_ngcontent-%COMP%]{color:#fff;background-color:#f44336}.mat-column-status[_ngcontent-%COMP%]   span.approved[_ngcontent-%COMP%]{color:#fff;background-color:#4caf50}"]}),t})(),tt=(()=>{class t{}return t.\u0275mod=d.Kb({type:t}),t.\u0275inj=d.Jb({factory:function(e){return new(e||t)},imports:[[C.c,p.b]]}),t})();var et=i("5Yg0"),it=i("gyTc"),st=i("R32p"),ot=i("qFsG"),rt=i("tVzd"),ct=i("J89Z"),nt=i("H0Zp"),at=i("p/0r"),lt=i("tyNb");const dt=[{path:"",component:Y}];let bt=(()=>{class t{}return t.\u0275mod=d.Kb({type:t}),t.\u0275inj=d.Jb({factory:function(e){return new(e||t)},imports:[[a.i,tt,C.c,et.a,st.a,c.c,c.c,it.a,p.b,n.p,E.e,ot.b,w.p,h.b,g.b,rt.a,ct.a,at.a,f.b,nt.a,m.e,a.r,P.b,R.b,lt.e.forChild(dt)]]}),t})()}}]);