(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"9gde":function(t,e,r){"use strict";r.r(e),r.d(e,"SuppliersPageModule",(function(){return dt}));var s=r("mrSG"),o=r("Dh3D"),i=r("x0BX"),a=r("+0xr"),n=r("fXoL"),c=r("9ZKQ"),d=r("u0tM"),l=r("swrf"),u=r("tyNb"),b=r("ZVi7"),p=r("BhS5"),m=r("WF9o"),h=r("4jEk"),f=r("ofXK"),g=r("bv9b"),I=r("bTqV"),y=r("NFeN");function S(t,e){1&t&&n.Nb(0,"mat-progress-bar",9)}function w(t,e){1&t&&(n.Sb(0,"th",10),n.Cc(1," Description "),n.Rb())}function C(t,e){if(1&t&&(n.Sb(0,"td",11),n.Cc(1),n.Rb()),2&t){const t=e.$implicit;n.Ab(1),n.Ec(" ",t.description," ")}}function v(t,e){1&t&&n.Nb(0,"th",12)}function R(t,e){if(1&t){const t=n.Tb();n.Sb(0,"td",11),n.Sb(1,"button",13),n.ac("click",(function(){n.rc(t);const r=e.$implicit;return n.ec().options(r)})),n.Sb(2,"mat-icon"),n.Cc(3," more_vert "),n.Rb(),n.Rb(),n.Rb()}}function A(t,e){1&t&&n.Nb(0,"tr",14)}function k(t,e){1&t&&n.Nb(0,"tr",15)}let N=(()=>{class t{constructor(t,e,r,s,o,i,n){this.toast=t,this.sheet=e,this.confirm=r,this.router=s,this.service=o,this.buttons=i,this.localstorage=n,this.columns=["description","options"],this.suppliers=new a.o,this.subscriptions={}}list(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.list({sort:{description:1},filter:["role","supplierId","description"]});this.suppliers.data=t.ok?t.result.map(t=>new i.a(t)):[],this.loading=!1}))}options(t){return Object(s.a)(this,void 0,void 0,(function*(){this.sheet.show({role:t.role,title:t.description,options:[{icon:"edit",title:"Edit Supplier",handler:()=>{this.router.navigate(["/suppliers","editor"],{queryParams:{mode:"update",supplierId:t.supplierId}})},disabled:[0,1]},{icon:"delete",title:"Delete",danger:!0,handler:()=>{this.confirm.show({message:"Delete "+t.description,handler:()=>Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const e=yield this.service.delete({supplierId:t.supplierId});if(e.ok){for(let e=0;e<this.suppliers.data.length;e++)if(this.suppliers.data[e].supplierId==t.supplierId){this.suppliers.data.splice(e,1);break}this.suppliers.data=this.suppliers.data.map(t=>new i.a(t)),this.toast.success("Supplier was removed!")}else this.toast.error(e.error.message);this.loading=!1}))})},disabled:[0,1,2,3,4]}]})}))}ngOnInit(){this.buttons.show("add"),this.buttons.hide("close"),this.buttons.hide("filter"),this.buttons.hide("search"),this.sort.active="description",this.sort.direction="desc",this.suppliers.sort=this.sort,this.subscriptions.add=this.buttons.add.click.subscribe(t=>{this.router.navigate(["/suppliers","editor"],{queryParams:{mode:"add"}})}),this.list()}ngOnDestroy(){this.subscriptions.add.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(c.a),n.Mb(d.a),n.Mb(l.a),n.Mb(u.b),n.Mb(b.a),n.Mb(p.a),n.Mb(m.a))},t.\u0275cmp=n.Gb({type:t,selectors:[["suppliers-page"]],viewQuery:function(t,e){var r;1&t&&n.wc(o.a,!0),2&t&&n.oc(r=n.bc())&&(e.sort=r.first)},decls:11,vars:5,consts:[["mode","indeterminate",4,"ngIf"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","description"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(n.Sb(0,"mat-content"),n.Ac(1,S,1,0,"mat-progress-bar",0),n.Sb(2,"table",1),n.Qb(3,2),n.Ac(4,w,2,0,"th",3),n.Ac(5,C,2,1,"td",4),n.Pb(),n.Qb(6,5),n.Ac(7,v,1,0,"th",6),n.Ac(8,R,4,0,"td",4),n.Pb(),n.Ac(9,A,1,0,"tr",7),n.Ac(10,k,1,0,"tr",8),n.Rb(),n.Rb()),2&t&&(n.Ab(1),n.kc("ngIf",e.loading),n.Ab(1),n.kc("dataSource",e.suppliers),n.Ab(7),n.kc("matHeaderRowDef",e.columns)("matHeaderRowDefSticky",!0),n.Ab(1),n.kc("matRowDefColumns",e.columns))},directives:[h.a,f.m,a.n,o.a,a.c,a.i,a.b,a.k,a.m,g.a,a.h,o.b,a.a,I.a,y.a,a.j,a.l],styles:[""]}),t})();var q=r("o3Q1"),D=r("3Pt+"),M=r("btHx"),E=r("dWDE"),T=r("kmnG"),O=r("d3UM"),V=r("FKr1"),x=r("WJ5W"),G=r("qFsG"),j=r("ihCf"),P=r("ZRfb"),F=r("AbOq"),H=r("roMP");function J(t,e){1&t&&n.Nb(0,"mat-progress-bar",23)}function Q(t,e){if(1&t&&(n.Sb(0,"mat-option",24),n.Cc(1),n.Rb()),2&t){const t=e.$implicit;n.kc("value",t.storeId)("disabled",t.role<2),n.Ab(1),n.Ec(" ",t.description," ")}}function Z(t,e){if(1&t&&(n.Sb(0,"mat-error"),n.Cc(1),n.Rb()),2&t){const t=n.ec();n.Ab(1),n.Ec(" ",t.errors.storeId," ")}}function B(t,e){if(1&t&&(n.Sb(0,"mat-error"),n.Cc(1),n.Rb()),2&t){const t=n.ec();n.Ab(1),n.Ec(" ",t.errors.email," ")}}function K(t,e){if(1&t&&(n.Sb(0,"mat-error"),n.Cc(1),n.Rb()),2&t){const t=n.ec();n.Ab(1),n.Ec(" ",t.errors.phone," ")}}function W(t,e){if(1&t&&(n.Sb(0,"mat-error"),n.Cc(1),n.Rb()),2&t){const t=n.ec();n.Ab(1),n.Ec(" ",t.errors.description," ")}}function L(t,e){if(1&t&&(n.Sb(0,"mat-error"),n.Cc(1),n.Rb()),2&t){const t=n.ec();n.Ab(1),n.Ec(" ",t.errors.address.street," ")}}function X(t,e){if(1&t&&(n.Sb(0,"mat-error"),n.Cc(1),n.Rb()),2&t){const t=n.ec();n.Ab(1),n.Ec(" ",t.errors.address.suburb," ")}}function $(t,e){if(1&t&&(n.Sb(0,"mat-error"),n.Cc(1),n.Rb()),2&t){const t=n.ec();n.Ab(1),n.Ec(" ",t.errors.address.cityTown," ")}}function z(t,e){if(1&t&&(n.Sb(0,"mat-error"),n.Cc(1),n.Rb()),2&t){const t=n.ec();n.Ab(1),n.Ec(" ",t.errors.address.postalCode," ")}}function Y(t,e){if(1&t&&(n.Sb(0,"mat-error"),n.Cc(1),n.Rb()),2&t){const t=n.ec();n.Ab(1),n.Ec(" ",t.errors.address.country," ")}}function U(t,e){if(1&t&&(n.Sb(0,"mat-error"),n.Cc(1),n.Rb()),2&t){const t=n.ec();n.Ab(1),n.Ec(" ",t.errors.address.additionalInfo," ")}}const _=function(t){return{description:t}};let tt=(()=>{class t{constructor(t,e,r,s,o,a,n){this.toast=t,this.route=e,this.stores=r,this.router=s,this.service=o,this.buttons=a,this.formerror=n,this.form=new D.f({address:new D.f({street:new D.c(null,[D.t.required]),suburb:new D.c(null,[D.t.required]),country:new D.c(null,[D.t.required]),cityTown:new D.c(null,[D.t.required]),postalCode:new D.c(null,[D.t.required]),additionalInfo:new D.c(null)}),phone:new D.c(null,[D.t.required]),email:new D.c(null,[D.t.required]),storeId:new D.c(null,[D.t.required]),description:new D.c(null,[D.t.required])}),this.errors={address:{street:"",suburb:"",country:"",cityTown:"",postalCode:"",additionalInfo:""},phone:"",email:"",storeId:"",description:""},this.filter=new D.f({store:new D.c(null,[D.t.required])}),this.supplier=new i.a,this.subscriptions={}}get(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.get({filter:["role","phone","email","address","storeId","supplierId","description"],supplierId:this.supplierId});t.ok?(this.supplier=new i.a(t.result),this.supplier.role>2?(this.form.controls.address.controls.street.setValue(this.supplier.address.street),this.form.controls.address.controls.suburb.setValue(this.supplier.address.suburb),this.form.controls.address.controls.country.setValue(this.supplier.address.country),this.form.controls.address.controls.cityTown.setValue(this.supplier.address.cityTown),this.form.controls.address.controls.postalCode.setValue(this.supplier.address.postalCode),this.form.controls.address.controls.additionalInfo.setValue(this.supplier.address.additionalInfo),this.form.controls.phone.setValue(this.supplier.phone),this.form.controls.email.setValue(this.supplier.email),this.form.controls.storeId.setValue(this.supplier.storeId),this.form.controls.description.setValue(this.supplier.description)):(this.toast.error("Your role is not high enough to copy/edit this supplier!"),this.router.navigate(["/suppliers"]))):(this.toast.error(t.error.message),this.router.navigate(["/suppliers"])),this.loading=!1}))}load(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.stores.list({sort:{description:1},filter:["storeId","description"]});t.ok?this.stores.data=t.result.map(t=>new q.a(t)):(this.stores.data=[],this.toast.error(t.error.message)),this.loading=!1}))}submit(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;let t=this.mode;"copy"==t&&(t="add",delete this.supplierId);const e=yield this.service[t]({address:{street:this.form.value.address.street,suburb:this.form.value.address.suburb,country:this.form.value.address.country,cityTown:this.form.value.address.cityTown,postalCode:this.form.value.address.postalCode,additionalInfo:this.form.value.address.additionalInfo},phone:this.form.value.phone,email:this.form.value.email,storeId:this.form.value.storeId,supplierId:this.supplierId,description:this.form.value.description});e.ok?this.router.navigate(["/suppliers"]):this.toast.error(e.error.message),this.loading=!1}))}ngOnInit(){this.buttons.hide("add"),this.buttons.show("close"),this.buttons.hide("filter"),this.buttons.hide("search"),this.subscriptions.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.subscriptions.close=this.buttons.close.click.subscribe(t=>{this.router.navigate(["/suppliers"])});const t=this.route.snapshot.queryParams;this.mode=t.mode,this.supplierId=t.supplierId,(()=>{Object(s.a)(this,void 0,void 0,(function*(){"add"!=this.mode&&(yield this.get()),yield this.load()}))})()}ngOnDestroy(){this.subscriptions.form.unsubscribe(),this.subscriptions.close.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(c.a),n.Mb(u.a),n.Mb(M.a),n.Mb(u.b),n.Mb(b.a),n.Mb(p.a),n.Mb(E.a))},t.\u0275cmp=n.Gb({type:t,selectors:[["suppliers-editor-page"]],decls:68,vars:22,consts:[["mode","indeterminate",4,"ngIf"],[1,"container"],[3,"formGroup","ngSubmit"],["appearance","outline"],["name","storeId","formControlName","storeId","required",""],[3,"formGroup"],["placeholderLabel","filter stores","noEntriesFoundLabel","no stores found","formControlName","store"],[3,"value","disabled",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","type","email","name","email","placeholder","email","formControlName","email","required",""],["matInput","","type","tel","name","phone","placeholder","phone","formControlName","phone","required",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],["formGroupName","address"],["matInput","","type","text","name","street","placeholder","street","formControlName","street","required",""],["matInput","","type","text","name","suburb","placeholder","suburb","formControlName","suburb","required",""],["matInput","","type","text","name","cityTown","placeholder","city/town","formControlName","cityTown","required",""],["matInput","","type","text","name","postalCode","placeholder","postal code","formControlName","postalCode","required",""],["appearance","outline","formGroupName","address"],["matInput","","type","text","name","country","placeholder","country","formControlName","country","required",""],["matInput","","name","additionalInfo","placeholder","additional info","formControlName","additionalInfo","cdkTextareaAutosize",""],["type","submit",2,"display","none"],["button",""],["type","button","color","primary","mat-flat-button","",3,"click"],["mode","indeterminate"],[3,"value","disabled"]],template:function(t,e){if(1&t){const t=n.Tb();n.Sb(0,"mat-content"),n.Ac(1,J,1,0,"mat-progress-bar",0),n.Sb(2,"div",1),n.Sb(3,"form",2),n.ac("ngSubmit",(function(){return!e.form.invalid&&!e.loading&&e.submit()})),n.Sb(4,"mat-form-field",3),n.Sb(5,"mat-label"),n.Cc(6," Store "),n.Rb(),n.Sb(7,"mat-select",4),n.Sb(8,"mat-option",5),n.Nb(9,"ngx-mat-select-search",6),n.Rb(),n.Ac(10,Q,2,3,"mat-option",7),n.fc(11,"filterBy"),n.fc(12,"orderBy"),n.Rb(),n.Ac(13,Z,2,1,"mat-error",8),n.Rb(),n.Sb(14,"mat-form-field",3),n.Sb(15,"mat-label"),n.Cc(16," Email "),n.Rb(),n.Nb(17,"input",9),n.Ac(18,B,2,1,"mat-error",8),n.Rb(),n.Sb(19,"mat-form-field",3),n.Sb(20,"mat-label"),n.Cc(21," Phone "),n.Rb(),n.Nb(22,"input",10),n.Ac(23,K,2,1,"mat-error",8),n.Rb(),n.Sb(24,"mat-form-field",3),n.Sb(25,"mat-label"),n.Cc(26," Description "),n.Rb(),n.Nb(27,"input",11),n.Ac(28,W,2,1,"mat-error",8),n.Rb(),n.Sb(29,"h2"),n.Cc(30," Address "),n.Rb(),n.Sb(31,"section",12),n.Sb(32,"mat-form-field",3),n.Sb(33,"mat-label"),n.Cc(34," Street "),n.Rb(),n.Nb(35,"input",13),n.Ac(36,L,2,1,"mat-error",8),n.Rb(),n.Sb(37,"mat-form-field",3),n.Sb(38,"mat-label"),n.Cc(39," Suburb "),n.Rb(),n.Nb(40,"input",14),n.Ac(41,X,2,1,"mat-error",8),n.Rb(),n.Rb(),n.Sb(42,"section",12),n.Sb(43,"mat-form-field",3),n.Sb(44,"mat-label"),n.Cc(45," City/Town "),n.Rb(),n.Nb(46,"input",15),n.Ac(47,$,2,1,"mat-error",8),n.Rb(),n.Sb(48,"mat-form-field",3),n.Sb(49,"mat-label"),n.Cc(50," Postal Code "),n.Rb(),n.Nb(51,"input",16),n.Ac(52,z,2,1,"mat-error",8),n.Rb(),n.Rb(),n.Sb(53,"mat-form-field",17),n.Sb(54,"mat-label"),n.Cc(55," Country "),n.Rb(),n.Nb(56,"input",18),n.Ac(57,Y,2,1,"mat-error",8),n.Rb(),n.Sb(58,"mat-form-field",17),n.Sb(59,"mat-label"),n.Cc(60," Additional Info "),n.Rb(),n.Nb(61,"textarea",19),n.Ac(62,U,2,1,"mat-error",8),n.Rb(),n.Nb(63,"button",20,21),n.Rb(),n.Rb(),n.Rb(),n.Sb(65,"mat-footer"),n.Sb(66,"button",22),n.ac("click",(function(){return n.rc(t),n.pc(64).click()})),n.Cc(67," submit "),n.Rb(),n.Rb()}2&t&&(n.Ab(1),n.kc("ngIf",e.loading),n.Ab(2),n.kc("formGroup",e.form),n.Ab(5),n.kc("formGroup",e.filter),n.Ab(2),n.kc("ngForOf",n.hc(11,14,n.hc(12,17,e.stores.data,"description"),n.mc(20,_,e.filter.value.store))),n.Ab(3),n.kc("ngIf",e.errors.storeId),n.Ab(5),n.kc("ngIf",e.errors.email),n.Ab(5),n.kc("ngIf",e.errors.phone),n.Ab(5),n.kc("ngIf",e.errors.description),n.Ab(8),n.kc("ngIf",e.errors.address.street),n.Ab(5),n.kc("ngIf",e.errors.address.suburb),n.Ab(6),n.kc("ngIf",e.errors.address.cityTown),n.Ab(5),n.kc("ngIf",e.errors.address.postalCode),n.Ab(5),n.kc("ngIf",e.errors.address.country),n.Ab(5),n.kc("ngIf",e.errors.address.additionalInfo))},directives:[h.a,f.m,D.u,D.n,D.g,T.c,T.f,O.a,D.m,D.e,D.s,V.k,x.a,f.l,G.a,D.b,D.h,j.b,P.a,I.a,g.a,T.b],pipes:[F.a,H.a],styles:[""]}),t})();var et=r("5Yg0"),rt=r("gyTc"),st=r("R32p"),ot=r("tVzd"),it=r("J89Z"),at=r("p/0r"),nt=r("H0Zp");const ct=[{path:"",component:N},{path:"editor",component:tt}];let dt=(()=>{class t{}return t.\u0275mod=n.Kb({type:t}),t.\u0275inj=n.Jb({factory:function(e){return new(e||t)},imports:[[D.i,f.c,et.a,st.a,o.c,o.c,rt.a,y.b,a.p,G.b,V.p,I.b,O.b,j.c,ot.a,it.a,at.a,nt.a,T.e,D.r,g.b,x.b,u.e.forChild(ct)]]}),t})()}}]);