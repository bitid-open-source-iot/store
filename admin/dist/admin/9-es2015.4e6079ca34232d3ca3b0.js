(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{NwyA:function(t,e,o){"use strict";o.d(e,"a",(function(){return c}));var i=o("ofXK"),r=o("NFeN"),s=o("MutI"),n=o("fXoL");let c=(()=>{class t{}return t.\u0275mod=n.Nb({type:t}),t.\u0275inj=n.Mb({factory:function(e){return new(e||t)},imports:[[i.c,r.b,s.c]]}),t})()},vDY7:function(t,e,o){"use strict";o.r(e),o.d(e,"CollectionPointsModule",(function(){return $}));var i=o("ojfV"),r=o("2xuv"),s=o("ofXK"),n=o("+PXZ"),c=o("3lET"),a=o("CSBE"),l=o("MutI"),d=o("NFeN"),b=o("qFsG"),u=o("d3UM"),p=o("bTqV"),m=o("0IaG"),h=o("FKr1"),f=o("/t3+"),g=o("NwyA"),y=o("kmnG"),C=o("2ChS"),I=o("bv9b"),V=o("mrSG"),v=o("+bmA"),w=o("KK9o"),O=o("IQQo"),U=o("HqD8"),P=o("nFDT"),k=o("jDep"),q=o("fXoL"),x=o("d3yR"),B=o("9ZKQ"),M=o("J4rr"),_=o("tyNb"),N=o("wPrS"),D=o("sC6t");function j(t,e){1&t&&q.Qb(0,"mat-progress-bar",9)}function z(t,e){if(1&t){const t=q.Wb();q.Vb(0,"mat-list-item",10),q.dc("click",(function(){q.uc(t);const o=e.$implicit;return q.hc().options(o)})),q.Vb(1,"section"),q.Vb(2,"h3"),q.Bc(3),q.Ub(),q.Vb(4,"p"),q.Bc(5),q.Ub(),q.Ub(),q.Ub()}if(2&t){const t=e.$implicit;q.Cb(3),q.Dc(" ",t.description," "),q.Cb(2),q.Fc(" ",t.address.street,", ",t.address.suburb,", ",t.address.cityTown,", ",t.address.postalCode," ")}}const T=function(t){return{mode:"add",storeId:t}};let A=(()=>{class t{constructor(t,e,o,i,r,s,n){this.menu=t,this.toast=e,this.sheet=o,this.dialog=i,this.collectionpoints=r,this.route=s,this.router=n,this.filter="",this.subscriptions={}}list(){return Object(V.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.collectionpoints.list({filter:["role","address","storeId","description","collectionpointId"]});this.collectionpoints.data=t.ok?t.result:[],this.loading=!1}))}options(t){return Object(V.a)(this,void 0,void 0,(function*(){const e=yield this.sheet.open(k.a,{data:{items:[{role:t.role,icon:"edit",scope:3,title:"Edit",option:1},{role:t.role,icon:"file_copy",scope:3,title:"Copy",option:2},{role:t.role,icon:"share",scope:4,title:"Share",option:3},{role:t.role,icon:"people",scope:4,title:"Subscribers",option:4},{role:t.role,icon:"remove",scope:1,color:"warn",title:"Unsubscribe",option:5},{role:t.role,icon:"delete",scope:5,color:"warn",title:"Delete",option:6}],title:t.description}});yield e.afterDismissed().subscribe(e=>Object(V.a)(this,void 0,void 0,(function*(){if(e)switch(e){case 1:this.router.navigate(["/collection-points","editor"],{queryParams:{mode:"update",storeId:this.storeId,collectionpointId:t.collectionpointId}});break;case 2:this.router.navigate(["/collection-points","editor"],{queryParams:{mode:"copy",storeId:this.storeId,collectionpointId:t.collectionpointId}});break;case 3:const e=yield this.dialog.open(v.a,{panelClass:"share-dialog"});yield e.afterClosed().subscribe(e=>Object(V.a)(this,void 0,void 0,(function*(){if(e){this.loading=!0;const o=yield this.collectionpoints.share({role:e.role,email:e.email,storeId:this.storeId,collectionpointId:t.collectionpointId});o.ok?this.toast.success("user was shared!"):this.toast.error(o.error.message),this.loading=!1}})));break;case 4:this.dialog.open(P.a,{data:{id:t.collectionpointId,type:"collectionpoint",storeId:this.storeId,service:this.collectionpoints},panelClass:"subscribers-dialog"});break;case 5:const o=yield this.dialog.open(U.a,{panelClass:"unsubscribe-dialog"});yield o.afterClosed().subscribe(e=>Object(V.a)(this,void 0,void 0,(function*(){if(e){this.loading=!0;const e=yield this.collectionpoints.unsubscribe({storeId:this.storeId,collectionpointId:t.collectionpointId});e.ok?this.toast.success("you were unsubscribed from collection point!"):this.toast.error(e.error.message),this.loading=!1}})));break;case 6:const i=yield this.dialog.open(w.a,{panelClass:"delete-dialog"});yield i.afterClosed().subscribe(e=>Object(V.a)(this,void 0,void 0,(function*(){if(e){this.loading=!0;const e=yield this.collectionpoints.delete({storeId:this.storeId,collectionpointId:t.collectionpointId});e.ok?this.toast.success("collection point was deleted!"):this.toast.error(e.error.message),this.loading=!1}})))}})))}))}ngOnInit(){this.subscriptions.route=this.route.queryParams.subscribe(t=>{void 0!==t.storeId&&null!=t.storeId&&""!=t.storeId?(this.storeId=t.storeId,this.list()):this.router.navigate(["/stores"])}),this.subscriptions.search=this.search.change.subscribe(t=>{this.filter=t})}ngOnDestroy(){this.subscriptions.route.unsubscribe(),this.subscriptions.search.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(q.Pb(x.a),q.Pb(B.a),q.Pb(C.b),q.Pb(m.b),q.Pb(M.a),q.Pb(_.a),q.Pb(_.c))},t.\u0275cmp=q.Jb({type:t,selectors:[["app-collection-points-page"]],viewQuery:function(t,e){var o;1&t&&q.yc(O.a,!0),2&t&&q.rc(o=q.ec())&&(e.search=o.first)},decls:16,vars:12,consts:[["color","primary"],["mat-icon-button","",1,"menu-toggle",3,"click"],[1,"page-title","spacer"],["placeholder","search collection points"],["mat-icon-button","","routerLink","editor",3,"queryParams"],["mode","indeterminate",4,"ngIf"],[1,"page-body"],[1,"column-list"],["matRipple","",3,"click",4,"ngFor","ngForOf"],["mode","indeterminate"],["matRipple","",3,"click"]],template:function(t,e){1&t&&(q.Vb(0,"mat-toolbar",0),q.Vb(1,"button",1),q.dc("click",(function(){return e.menu.toggle()})),q.Vb(2,"mat-icon"),q.Bc(3," menu "),q.Ub(),q.Ub(),q.Vb(4,"label",2),q.Bc(5," collection points "),q.Ub(),q.Qb(6,"search",3),q.Vb(7,"button",4),q.Vb(8,"mat-icon"),q.Bc(9," add "),q.Ub(),q.Ub(),q.Ub(),q.Ac(10,j,1,0,"mat-progress-bar",5),q.Vb(11,"div",6),q.Vb(12,"mat-list",7),q.Ac(13,z,6,5,"mat-list-item",8),q.ic(14,"filterBy"),q.ic(15,"orderBy"),q.Ub(),q.Ub()),2&t&&(q.Cb(7),q.oc("queryParams",q.qc(10,T,e.storeId)),q.Cb(3),q.oc("ngIf",e.loading),q.Cb(3),q.oc("ngForOf",q.lc(14,3,q.kc(15,7,e.collectionpoints.data,"description"),"description",e.filter)))},directives:[f.a,p.a,d.a,O.a,_.d,s.l,l.a,s.k,I.a,l.b,h.o],pipes:[N.a,D.a],styles:["mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{cursor:pointer;border-bottom:1px solid #e0e0e0}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:14px;line-height:14px;text-transform:uppercase}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:12px;line-height:12px;text-transform:uppercase}"]}),t})();var Q=o("3Pt+"),S=o("5mtf"),F=o("dWDE");function G(t,e){1&t&&q.Qb(0,"mat-progress-bar",18)}function K(t,e){if(1&t&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&t){const t=q.hc();q.Cb(1),q.Dc(" ",t.errors.description," ")}}function J(t,e){if(1&t&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&t){const t=q.hc();q.Cb(1),q.Dc(" ",t.errors.organizationOnly," ")}}function R(t,e){if(1&t&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&t){const t=q.hc();q.Cb(1),q.Dc(" ",t.errors.address.street," ")}}function X(t,e){if(1&t&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&t){const t=q.hc();q.Cb(1),q.Dc(" ",t.errors.address.suburb," ")}}function E(t,e){if(1&t&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&t){const t=q.hc();q.Cb(1),q.Dc(" ",t.errors.address.cityTown," ")}}function L(t,e){if(1&t&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&t){const t=q.hc();q.Cb(1),q.Dc(" ",t.errors.address.postalCode," ")}}const W=[{path:"",component:A},{path:"editor",component:(()=>{class t{constructor(t,e,o,i,r){this.route=t,this.toast=e,this.service=o,this.history=i,this.formerror=r,this.form=new Q.d({address:new Q.d({street:new Q.b("",[Q.q.required]),suburb:new Q.b("",[Q.q.required]),cityTown:new Q.b("",[Q.q.required]),postalCode:new Q.b("",[Q.q.required])}),description:new Q.b("",[Q.q.required]),organizationOnly:new Q.b(1,[Q.q.required])}),this.errors={address:{street:"",suburb:"",cityTown:"",postalCode:""},description:"",organizationOnly:""},this.subscriptions={}}get(){return Object(V.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.get({filter:["role","address","description","organizationOnly"],storeId:this.storeId,collectionpointId:this.collectionpointId});if(t.ok){t.result.role<3&&this.history.back();const e=this.form.controls.address;e.controls.street.setValue(t.result.address.street),e.controls.suburb.setValue(t.result.address.suburb),e.controls.cityTown.setValue(t.result.address.cityTown),e.controls.postalCode.setValue(t.result.address.postalCode),this.form.controls.description.setValue(t.result.description),this.form.controls.organizationOnly.setValue(t.result.organizationOnly)}else this.toast.error(t.error.message);this.loading=!1}))}submit(){return Object(V.a)(this,void 0,void 0,(function*(){this.loading=!0;let t=this.mode;"copy"==t&&(t="add",delete this.collectionpointId);const e=yield this.service[t]({address:this.form.value.address,storeId:this.storeId,description:this.form.value.description,organizationOnly:this.form.value.organizationOnly,collectionpointId:this.collectionpointId});e.ok?(this.toast.success("collection point was updated!"),this.history.back()):this.toast.error(e.error.message),this.loading=!1}))}ngOnInit(){this.subscriptions.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.subscriptions.route=this.route.queryParams.subscribe(t=>{this.mode=t.mode,this.storeId=t.storeId,this.collectionpointId=t.collectionpointId,"add"!=this.mode&&this.get()})}ngOnDestroy(){this.subscriptions.form.unsubscribe(),this.subscriptions.route.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(q.Pb(_.a),q.Pb(B.a),q.Pb(M.a),q.Pb(S.a),q.Pb(F.a))},t.\u0275cmp=q.Jb({type:t,selectors:[["app-collection-point-editor-page"]],decls:48,vars:10,consts:[["color","primary"],["mat-icon-button","",1,"menu-toggle",3,"click"],[1,"page-title","spacer"],["mode","indeterminate",4,"ngIf"],[1,"page-body"],[3,"formGroup","ngSubmit"],["appearance","outline"],["text-uppercase",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],[4,"ngIf"],["name","organizationOnly","placeholder","Sharing Rules","formControlName","organizationOnly","required",""],[3,"value"],["formGroupName","address"],["matInput","","type","text","name","street","placeholder","street","formControlName","street","required",""],["matInput","","type","text","name","suburb","placeholder","suburb","formControlName","suburb","required",""],["matInput","","type","text","name","cityTown","placeholder","City/Town","formControlName","cityTown","required",""],["matInput","","type","text","name","postalCode","placeholder","Postal Code","formControlName","postalCode","required",""],["type","submit","mat-flat-button","","color","primary"],["mode","indeterminate"]],template:function(t,e){1&t&&(q.Vb(0,"mat-toolbar",0),q.Vb(1,"button",1),q.dc("click",(function(){return e.history.back()})),q.Vb(2,"mat-icon"),q.Bc(3," arrow_back "),q.Ub(),q.Ub(),q.Vb(4,"label",2),q.Bc(5," supplier editor "),q.Ub(),q.Ub(),q.Ac(6,G,1,0,"mat-progress-bar",3),q.Vb(7,"div",4),q.Vb(8,"form",5),q.dc("ngSubmit",(function(){return!e.form.invalid&&!e.loading&&e.submit()})),q.Vb(9,"mat-form-field",6),q.Vb(10,"mat-label",7),q.Bc(11," description "),q.Ub(),q.Qb(12,"input",8),q.Ac(13,K,2,1,"mat-error",9),q.Ub(),q.Vb(14,"mat-form-field",6),q.Vb(15,"mat-label",7),q.Bc(16," Sharing Rules "),q.Ub(),q.Vb(17,"mat-select",10),q.Vb(18,"mat-option",11),q.Bc(19," Share To Anyone "),q.Ub(),q.Vb(20,"mat-option",11),q.Bc(21," Share In Organization "),q.Ub(),q.Ub(),q.Ac(22,J,2,1,"mat-error",9),q.Ub(),q.Vb(23,"h2"),q.Bc(24," address "),q.Ub(),q.Vb(25,"div",12),q.Vb(26,"mat-form-field",6),q.Vb(27,"mat-label",7),q.Bc(28," street "),q.Ub(),q.Qb(29,"input",13),q.Ac(30,R,2,1,"mat-error",9),q.Ub(),q.Vb(31,"mat-form-field",6),q.Vb(32,"mat-label",7),q.Bc(33," suburb "),q.Ub(),q.Qb(34,"input",14),q.Ac(35,X,2,1,"mat-error",9),q.Ub(),q.Vb(36,"mat-form-field",6),q.Vb(37,"mat-label",7),q.Bc(38," City/Town "),q.Ub(),q.Qb(39,"input",15),q.Ac(40,E,2,1,"mat-error",9),q.Ub(),q.Vb(41,"mat-form-field",6),q.Vb(42,"mat-label",7),q.Bc(43," Postal Code "),q.Ub(),q.Qb(44,"input",16),q.Ac(45,L,2,1,"mat-error",9),q.Ub(),q.Ub(),q.Vb(46,"button",17),q.Bc(47," submit "),q.Ub(),q.Ub(),q.Ub()),2&t&&(q.Cb(6),q.oc("ngIf",e.loading),q.Cb(2),q.oc("formGroup",e.form),q.Cb(5),q.oc("ngIf",e.errors.description),q.Cb(5),q.oc("value",0),q.Cb(2),q.oc("value",1),q.Cb(2),q.oc("ngIf",e.errors.organizationOnly),q.Cb(8),q.oc("ngIf",e.errors.address.street),q.Cb(5),q.oc("ngIf",e.errors.address.suburb),q.Cb(5),q.oc("ngIf",e.errors.address.cityTown),q.Cb(5),q.oc("ngIf",e.errors.address.postalCode))},directives:[f.a,p.a,d.a,s.l,Q.r,Q.k,Q.e,y.c,y.g,b.a,Q.a,Q.j,Q.c,Q.p,u.a,h.k,Q.f,I.a,y.b],styles:["form[_ngcontent-%COMP%]{width:400px;margin:10px auto}form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px;line-height:14px;margin:0 0 5px;text-transform:uppercase}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}@media screen and (max-width:420px){form[_ngcontent-%COMP%]{width:calc(100% - 20px);margin:10px}}"]}),t})()}];let Z=(()=>{class t{}return t.\u0275mod=q.Nb({type:t}),t.\u0275inj=q.Mb({factory:function(e){return new(e||t)},imports:[[_.f.forChild(W)],_.f]}),t})(),$=(()=>{class t{}return t.\u0275mod=q.Nb({type:t}),t.\u0275inj=q.Mb({factory:function(e){return new(e||t)},imports:[[i.a,r.a,Q.g,n.a,c.a,a.a,s.c,d.b,l.c,b.b,u.b,m.c,p.b,h.p,f.b,y.e,g.a,Q.o,C.c,I.b,Z]]}),t})()}}]);