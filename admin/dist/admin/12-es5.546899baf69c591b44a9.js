function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{NwyA:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("ofXK"),i=r("NFeN"),o=r("MutI"),s=r("fXoL"),a=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=s.Nb({type:e}),e.\u0275inj=s.Mb({factory:function(t){return new(t||e)},imports:[[n.c,i.b,o.c]]}),e}()},ZGGN:function(e,t,r){"use strict";r.r(t),r.d(t,"DepartmentsModule",(function(){return $}));var n=r("2xuv"),i=r("ojfV"),o=r("ofXK"),s=r("+PXZ"),a=r("3lET"),c=r("CSBE"),u=r("NFeN"),d=r("MutI"),l=r("qFsG"),p=r("0IaG"),b=r("FKr1"),m=r("d3UM"),h=r("bTqV"),f=r("/t3+"),g=r("kmnG"),v=r("NwyA"),y=r("bv9b"),I=r("2ChS"),k=r("mrSG"),C=r("+bmA"),w=r("KK9o"),x=r("IQQo"),O=r("HqD8"),P=r("nFDT"),V=r("jDep"),U=r("fXoL"),_=r("d3yR"),R=r("9ZKQ"),M=r("G0b6"),q=r("tyNb"),B=r("wPrS"),j=r("sC6t");function z(e,t){1&e&&U.Qb(0,"mat-progress-bar",8)}function N(e,t){if(1&e){var r=U.Wb();U.Vb(0,"mat-list-item",9),U.dc("click",(function(){U.uc(r);var e=t.$implicit;return U.hc().options(e)})),U.Vb(1,"h3"),U.Bc(2),U.Ub(),U.Ub()}if(2&e){var n=t.$implicit;U.Cb(2),U.Dc(" ",n.description," ")}}var D,S=function(e){return{mode:"add",storeId:e}},A=((D=function(){function e(t,r,n,i,o,s,a){_classCallCheck(this,e),this.menu=t,this.toast=r,this.sheet=n,this.dialog=i,this.departments=o,this.route=s,this.router=a,this.filter="",this.subscriptions={}}return _createClass(e,[{key:"list",value:function(){return Object(k.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.departments.list({filter:["role","storeId","description","departmentId"]});case 3:t=e.sent,this.departments.data=t.ok?t.result:[],this.loading=!1;case 5:case"end":return e.stop()}}),e,this)})))}},{key:"options",value:function(e){return Object(k.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sheet.open(V.a,{data:{items:[{role:e.role,icon:"edit",scope:3,title:"Edit",option:1},{role:e.role,icon:"file_copy",scope:3,title:"Copy",option:2},{role:e.role,icon:"share",scope:4,title:"Share",option:3},{role:e.role,icon:"people",scope:4,title:"Subscribers",option:4},{role:e.role,icon:"remove",scope:1,color:"warn",title:"Unsubscribe",option:5},{role:e.role,icon:"delete",scope:5,color:"warn",title:"Delete",option:6}],title:e.description}});case 2:return r=t.sent,t.next=5,r.afterDismissed().subscribe((function(t){return Object(k.a)(n,void 0,void 0,regeneratorRuntime.mark((function r(){var n,i,o,s=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=27;break}r.t0=t,r.next=1===r.t0?4:2===r.t0?6:3===r.t0?8:4===r.t0?14:5===r.t0?16:6===r.t0?22:27;break;case 4:return this.router.navigate(["/departments","editor"],{queryParams:{mode:"update",storeId:this.storeId,departmentId:e.departmentId}}),r.abrupt("break",27);case 6:return this.router.navigate(["/departments","editor"],{queryParams:{mode:"copy",storeId:this.storeId,departmentId:e.departmentId}}),r.abrupt("break",27);case 8:return r.next=10,this.dialog.open(C.a,{panelClass:"share-dialog"});case 10:return n=r.sent,r.next=13,n.afterClosed().subscribe((function(t){return Object(k.a)(s,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=6;break}return this.loading=!0,r.next=4,this.departments.share({role:t.role,email:t.email,storeId:this.storeId,departmentId:e.departmentId});case 4:(n=r.sent).ok?this.toast.success("user was shared!"):this.toast.error(n.error.message),this.loading=!1;case 6:case"end":return r.stop()}}),r,this)})))}));case 13:return r.abrupt("break",27);case 14:return this.dialog.open(P.a,{data:{id:e.departmentId,type:"department",storeId:this.storeId,service:this.departments},panelClass:"subscribers-dialog"}),r.abrupt("break",27);case 16:return r.next=18,this.dialog.open(O.a,{panelClass:"unsubscribe-dialog"});case 18:return i=r.sent,r.next=21,i.afterClosed().subscribe((function(t){return Object(k.a)(s,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=6;break}return this.loading=!0,r.next=4,this.departments.unsubscribe({storeId:this.storeId,departmentId:e.departmentId});case 4:(n=r.sent).ok?this.toast.success("you were unsubscribed from department!"):this.toast.error(n.error.message),this.loading=!1;case 6:case"end":return r.stop()}}),r,this)})))}));case 21:return r.abrupt("break",27);case 22:return r.next=24,this.dialog.open(w.a,{panelClass:"delete-dialog"});case 24:return o=r.sent,r.next=27,o.afterClosed().subscribe((function(t){return Object(k.a)(s,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=6;break}return this.loading=!0,r.next=4,this.departments.delete({storeId:this.storeId,departmentId:e.departmentId});case 4:(n=r.sent).ok?this.toast.success("department was deleted!"):this.toast.error(n.error.message),this.loading=!1;case 6:case"end":return r.stop()}}),r,this)})))}));case 27:case"end":return r.stop()}}),r,this)})))}));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){var e=this;this.subscriptions.route=this.route.queryParams.subscribe((function(t){void 0!==t.storeId&&null!=t.storeId&&""!=t.storeId?(e.storeId=t.storeId,e.list()):e.router.navigate(["/stores"])})),this.subscriptions.search=this.search.change.subscribe((function(t){e.filter=t}))}},{key:"ngOnDestroy",value:function(){this.subscriptions.route.unsubscribe(),this.subscriptions.search.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||D)(U.Pb(_.a),U.Pb(R.a),U.Pb(I.b),U.Pb(p.b),U.Pb(M.a),U.Pb(q.a),U.Pb(q.c))},D.\u0275cmp=U.Jb({type:D,selectors:[["app-departments-page"]],viewQuery:function(e,t){var r;1&e&&U.yc(x.a,!0),2&e&&U.rc(r=U.ec())&&(t.search=r.first)},decls:16,vars:12,consts:[["color","primary"],["mat-icon-button","",1,"menu-toggle",3,"click"],[1,"page-title","spacer"],["placeholder","search departments"],["mat-icon-button","","routerLink","editor",3,"queryParams"],["mode","indeterminate",4,"ngIf"],[1,"page-body"],["matRipple","",3,"click",4,"ngFor","ngForOf"],["mode","indeterminate"],["matRipple","",3,"click"]],template:function(e,t){1&e&&(U.Vb(0,"mat-toolbar",0),U.Vb(1,"button",1),U.dc("click",(function(){return t.menu.toggle()})),U.Vb(2,"mat-icon"),U.Bc(3," menu "),U.Ub(),U.Ub(),U.Vb(4,"label",2),U.Bc(5," departments "),U.Ub(),U.Qb(6,"search",3),U.Vb(7,"button",4),U.Vb(8,"mat-icon"),U.Bc(9," add "),U.Ub(),U.Ub(),U.Ub(),U.Ac(10,z,1,0,"mat-progress-bar",5),U.Vb(11,"div",6),U.Vb(12,"mat-list"),U.Ac(13,N,3,1,"mat-list-item",7),U.ic(14,"filterBy"),U.ic(15,"orderBy"),U.Ub(),U.Ub()),2&e&&(U.Cb(7),U.oc("queryParams",U.qc(10,S,t.storeId)),U.Cb(3),U.oc("ngIf",t.loading),U.Cb(3),U.oc("ngForOf",U.lc(14,3,U.kc(15,7,t.departments.data,"description"),"description",t.filter)))},directives:[f.a,h.a,u.a,x.a,q.d,o.l,d.a,o.k,y.a,d.b,b.o],pipes:[B.a,j.a],styles:["mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{flex:1 auto;cursor:pointer;display:flex;align-items:center;border-bottom:1px solid #e0e0e0;flex-direction:row}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:14px;line-height:14px;text-transform:uppercase}"]}),D),F=r("3Pt+"),G=r("5mtf"),Q=r("dWDE");function K(e,t){1&e&&U.Qb(0,"mat-progress-bar",13)}function E(e,t){if(1&e&&(U.Vb(0,"mat-error"),U.Bc(1),U.Ub()),2&e){var r=U.hc();U.Cb(1),U.Dc(" ",r.errors.description," ")}}function T(e,t){if(1&e&&(U.Vb(0,"mat-error"),U.Bc(1),U.Ub()),2&e){var r=U.hc();U.Cb(1),U.Dc(" ",r.errors.organizationOnly," ")}}var X,J,L,Z=[{path:"",component:A},{path:"editor",component:(X=function(){function e(t,r,n,i,o){_classCallCheck(this,e),this.route=t,this.toast=r,this.service=n,this.history=i,this.formerror=o,this.form=new F.d({description:new F.b("",[F.q.required]),organizationOnly:new F.b(1,[F.q.required])}),this.errors={description:"",organizationOnly:""},this.subscriptions={}}return _createClass(e,[{key:"get",value:function(){return Object(k.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.service.get({filter:["role","description","organizationOnly"],storeId:this.storeId,departmentId:this.departmentId});case 3:(t=e.sent).ok?(t.result.role<3&&this.history.back(),this.form.controls.description.setValue(t.result.description),this.form.controls.organizationOnly.setValue(t.result.organizationOnly)):this.toast.error(t.error.message),this.loading=!1;case 5:case"end":return e.stop()}}),e,this)})))}},{key:"submit",value:function(){return Object(k.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,"copy"==(t=this.mode)&&(t="add",delete this.departmentId),e.next=5,this.service[t]({storeId:this.storeId,description:this.form.value.description,departmentId:this.departmentId,organizationOnly:this.form.value.organizationOnly});case 5:(r=e.sent).ok?(this.toast.success("department was updated!"),this.history.back()):this.toast.error(r.error.message),this.loading=!1;case 7:case"end":return e.stop()}}),e,this)})))}},{key:"ngOnInit",value:function(){var e=this;this.subscriptions.form=this.form.valueChanges.subscribe((function(t){e.errors=e.formerror.validateForm(e.form,e.errors,!0)})),this.subscriptions.route=this.route.queryParams.subscribe((function(t){e.mode=t.mode,e.storeId=t.storeId,e.departmentId=t.departmentId,"add"!=e.mode&&e.get()}))}},{key:"ngOnDestroy",value:function(){this.subscriptions.form.unsubscribe(),this.subscriptions.route.unsubscribe()}}]),e}(),X.\u0275fac=function(e){return new(e||X)(U.Pb(q.a),U.Pb(R.a),U.Pb(M.a),U.Pb(G.a),U.Pb(Q.a))},X.\u0275cmp=U.Jb({type:X,selectors:[["app-department-editor-page"]],decls:25,vars:6,consts:[["color","primary"],["mat-icon-button","",1,"menu-toggle",3,"click"],[1,"page-title","spacer"],["mode","indeterminate",4,"ngIf"],[1,"page-body"],[3,"formGroup","ngSubmit"],["appearance","outline"],["text-uppercase",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],[4,"ngIf"],["name","organizationOnly","placeholder","Sharing Rules","formControlName","organizationOnly","required",""],[3,"value"],["type","submit","mat-flat-button","","color","primary"],["mode","indeterminate"]],template:function(e,t){1&e&&(U.Vb(0,"mat-toolbar",0),U.Vb(1,"button",1),U.dc("click",(function(){return t.history.back()})),U.Vb(2,"mat-icon"),U.Bc(3," arrow_back "),U.Ub(),U.Ub(),U.Vb(4,"label",2),U.Bc(5," department editor "),U.Ub(),U.Ub(),U.Ac(6,K,1,0,"mat-progress-bar",3),U.Vb(7,"div",4),U.Vb(8,"form",5),U.dc("ngSubmit",(function(){return!t.form.invalid&&!t.loading&&t.submit()})),U.Vb(9,"mat-form-field",6),U.Vb(10,"mat-label",7),U.Bc(11," description "),U.Ub(),U.Qb(12,"input",8),U.Ac(13,E,2,1,"mat-error",9),U.Ub(),U.Vb(14,"mat-form-field",6),U.Vb(15,"mat-label",7),U.Bc(16," Sharing Rules "),U.Ub(),U.Vb(17,"mat-select",10),U.Vb(18,"mat-option",11),U.Bc(19," Share To Anyone "),U.Ub(),U.Vb(20,"mat-option",11),U.Bc(21," Share In Organization "),U.Ub(),U.Ub(),U.Ac(22,T,2,1,"mat-error",9),U.Ub(),U.Vb(23,"button",12),U.Bc(24," submit "),U.Ub(),U.Ub(),U.Ub()),2&e&&(U.Cb(6),U.oc("ngIf",t.loading),U.Cb(2),U.oc("formGroup",t.form),U.Cb(5),U.oc("ngIf",t.errors.description),U.Cb(5),U.oc("value",0),U.Cb(2),U.oc("value",1),U.Cb(2),U.oc("ngIf",t.errors.organizationOnly))},directives:[f.a,h.a,u.a,o.l,F.r,F.k,F.e,g.c,g.g,l.a,F.a,F.j,F.c,F.p,m.a,b.k,y.a,g.b],styles:["form[_ngcontent-%COMP%]{width:400px;margin:10px auto}form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px;line-height:14px;margin:0 0 5px;text-transform:uppercase}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}@media screen and (max-width:420px){form[_ngcontent-%COMP%]{width:calc(100% - 20px);margin:10px}}"]}),X)}],W=((L=function e(){_classCallCheck(this,e)}).\u0275mod=U.Nb({type:L}),L.\u0275inj=U.Mb({factory:function(e){return new(e||L)},imports:[[q.f.forChild(Z)],q.f]}),L),$=((J=function e(){_classCallCheck(this,e)}).\u0275mod=U.Nb({type:J}),J.\u0275inj=U.Mb({factory:function(e){return new(e||J)},imports:[[i.a,n.a,F.g,s.a,a.a,c.a,o.c,u.b,d.c,l.b,m.b,p.c,h.b,b.p,f.b,g.e,v.a,F.o,I.c,y.b,W]]}),J)}}]);