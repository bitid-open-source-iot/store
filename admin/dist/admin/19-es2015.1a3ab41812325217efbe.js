(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"0qSw":function(t,o,e){"use strict";e.r(o),e.d(o,"CouriersModule",(function(){return ot}));var n=e("2xuv"),i=e("ojfV"),r=e("+PXZ"),s=e("3lET"),c=e("CSBE"),a=e("ofXK"),l=e("MutI"),d=e("NFeN"),b=e("qFsG"),u=e("0IaG"),p=e("bTqV"),m=e("d3UM"),h=e("FKr1"),g=e("/t3+"),f=e("NwyA"),C=e("kmnG"),O=e("bv9b"),M=e("2ChS"),I=e("mrSG"),P=e("+bmA"),y=e("KK9o"),x=e("IQQo"),V=e("HqD8"),_=e("nFDT"),v=e("jDep"),U=e("fXoL"),w=e("d3yR"),k=e("9ZKQ"),q=e("vmqu"),B=e("tyNb"),z=e("wPrS"),A=e("sC6t");function D(t,o){1&t&&U.Qb(0,"mat-progress-bar",8)}function Q(t,o){if(1&t){const t=U.Wb();U.Vb(0,"mat-list-item",9),U.dc("click",(function(){U.uc(t);const e=o.$implicit;return U.hc().options(e)})),U.Qb(1,"img",10),U.Vb(2,"h3"),U.Bc(3),U.Ub(),U.Ub()}if(2&t){const t=o.$implicit;U.Cb(1),U.oc("src",t.icon,U.vc)("alt",t.description),U.Cb(2),U.Dc(" ",t.description," ")}}const S=function(t){return{mode:"add",storeId:t}};let j=(()=>{class t{constructor(t,o,e,n,i,r,s){this.menu=t,this.toast=o,this.sheet=e,this.dialog=n,this.couriers=i,this.route=r,this.router=s,this.filter="",this.subscriptions={}}list(){return Object(I.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.couriers.list({filter:["role","icon","storeId","courierId","description"],storeId:this.storeId});this.couriers.data=t.ok?t.result:[],this.loading=!1}))}options(t){return Object(I.a)(this,void 0,void 0,(function*(){const o=yield this.sheet.open(v.a,{data:{items:[{role:t.role,icon:"edit",scope:3,title:"Edit",option:1},{role:t.role,icon:"file_copy",scope:3,title:"Copy",option:2},{role:t.role,icon:"share",scope:4,title:"Share",option:3},{role:t.role,icon:"people",scope:4,title:"Subscribers",option:4},{role:t.role,icon:"remove",scope:1,color:"warn",title:"Unsubscribe",option:5},{role:t.role,icon:"delete",scope:5,color:"warn",title:"Delete",option:6}],title:t.description}});yield o.afterDismissed().subscribe(o=>Object(I.a)(this,void 0,void 0,(function*(){if(o)switch(o){case 1:this.router.navigate(["/couriers","editor"],{queryParams:{mode:"update",storeId:this.storeId,courierId:t.courierId}});break;case 2:this.router.navigate(["/couriers","editor"],{queryParams:{mode:"copy",storeId:this.storeId,courierId:t.courierId}});break;case 3:const o=yield this.dialog.open(P.a,{panelClass:"share-dialog"});yield o.afterClosed().subscribe(o=>Object(I.a)(this,void 0,void 0,(function*(){if(o){this.loading=!0;const e=yield this.couriers.share({role:o.role,email:o.email,storeId:this.storeId,courierId:t.courierId});e.ok?this.toast.success("user was shared!"):this.toast.error(e.error.message),this.loading=!1}})));break;case 4:this.dialog.open(_.a,{data:{id:t.courierId,type:"courier",storeId:this.storeId,service:this.couriers},panelClass:"subscribers-dialog"});break;case 5:const e=yield this.dialog.open(V.a,{panelClass:"unsubscribe-dialog"});yield e.afterClosed().subscribe(o=>Object(I.a)(this,void 0,void 0,(function*(){if(o){this.loading=!0;const o=yield this.couriers.unsubscribe({storeId:this.storeId,courierId:t.courierId});o.ok?this.toast.success("you were unsubscribed from courier!"):this.toast.error(o.error.message),this.loading=!1}})));break;case 6:const n=yield this.dialog.open(y.a,{panelClass:"delete-dialog"});yield n.afterClosed().subscribe(o=>Object(I.a)(this,void 0,void 0,(function*(){if(o){this.loading=!0;const o=yield this.couriers.delete({storeId:this.storeId,courierId:t.courierId});o.ok?this.toast.success("courier was deleted!"):this.toast.error(o.error.message),this.loading=!1}})))}})))}))}ngOnInit(){this.subscriptions.route=this.route.queryParams.subscribe(t=>{void 0!==t.storeId&&null!=t.storeId&&""!=t.storeId?(this.storeId=t.storeId,this.list()):this.router.navigate(["/stores"])}),this.subscriptions.search=this.search.change.subscribe(t=>{this.filter=t})}ngOnDestroy(){this.subscriptions.route.unsubscribe(),this.subscriptions.search.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(U.Pb(w.a),U.Pb(k.a),U.Pb(M.b),U.Pb(u.b),U.Pb(q.a),U.Pb(B.a),U.Pb(B.c))},t.\u0275cmp=U.Jb({type:t,selectors:[["app-couriers-page"]],viewQuery:function(t,o){var e;1&t&&U.yc(x.a,!0),2&t&&U.rc(e=U.ec())&&(o.search=e.first)},decls:16,vars:12,consts:[["color","primary"],["mat-icon-button","",1,"menu-toggle",3,"click"],[1,"page-title","spacer"],["placeholder","search couriers"],["mat-icon-button","","routerLink","editor",3,"queryParams"],["mode","indeterminate",4,"ngIf"],[1,"page-body"],["matRipple","",3,"click",4,"ngFor","ngForOf"],["mode","indeterminate"],["matRipple","",3,"click"],[3,"src","alt"]],template:function(t,o){1&t&&(U.Vb(0,"mat-toolbar",0),U.Vb(1,"button",1),U.dc("click",(function(){return o.menu.toggle()})),U.Vb(2,"mat-icon"),U.Bc(3," menu "),U.Ub(),U.Ub(),U.Vb(4,"label",2),U.Bc(5," couriers "),U.Ub(),U.Qb(6,"search",3),U.Vb(7,"button",4),U.Vb(8,"mat-icon"),U.Bc(9," add "),U.Ub(),U.Ub(),U.Ub(),U.Ac(10,D,1,0,"mat-progress-bar",5),U.Vb(11,"div",6),U.Vb(12,"mat-list"),U.Ac(13,Q,4,3,"mat-list-item",7),U.ic(14,"filterBy"),U.ic(15,"orderBy"),U.Ub(),U.Ub()),2&t&&(U.Cb(7),U.oc("queryParams",U.qc(10,S,o.storeId)),U.Cb(3),U.oc("ngIf",o.loading),U.Cb(3),U.oc("ngForOf",U.lc(14,3,U.kc(15,7,o.couriers.data,"description"),"description",o.filter)))},directives:[g.a,p.a,d.a,x.a,B.d,a.m,l.a,a.l,O.a,l.b,h.r],pipes:[z.a,A.a],styles:["mat-list[_ngcontent-%COMP%]{padding:0!important}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{flex:1 auto;cursor:pointer;display:flex;align-items:center;border-bottom:1px solid #e0e0e0;flex-direction:row}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px;margin-right:15px;border-radius:4px}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:14px;line-height:14px;text-transform:uppercase}"]}),t})();var F=e("ZntH"),N=e("3Pt+"),G=e("5mtf"),K=e("dWDE");function R(t,o){1&t&&U.Qb(0,"mat-progress-bar",22)}function T(t,o){if(1&t&&(U.Vb(0,"mat-error"),U.Bc(1),U.Ub()),2&t){const t=U.hc();U.Cb(1),U.Dc(" ",t.errors.description," ")}}function $(t,o){if(1&t&&(U.Vb(0,"mat-error"),U.Bc(1),U.Ub()),2&t){const t=U.hc();U.Cb(1),U.Dc(" ",t.errors.account," ")}}function E(t,o){if(1&t&&(U.Vb(0,"mat-error"),U.Bc(1),U.Ub()),2&t){const t=U.hc();U.Cb(1),U.Dc(" ",t.errors.organizationOnly," ")}}function J(t,o){if(1&t&&(U.Vb(0,"mat-error"),U.Bc(1),U.Ub()),2&t){const t=U.hc();U.Cb(1),U.Dc(" ",t.errors.phone," ")}}function L(t,o){if(1&t&&(U.Vb(0,"mat-error"),U.Bc(1),U.Ub()),2&t){const t=U.hc();U.Cb(1),U.Dc(" ",t.errors.email," ")}}const W=function(){return{standalone:!0}};function X(t,o){if(1&t){const t=U.Wb();U.Vb(0,"tr"),U.Vb(1,"th"),U.Vb(2,"input",23),U.dc("ngModelChange",(function(e){return U.uc(t),o.$implicit.title=e})),U.Ub(),U.Ub(),U.Vb(3,"td"),U.Vb(4,"input",24),U.dc("ngModelChange",(function(e){return U.uc(t),o.$implicit.price=e})),U.Ub(),U.Ub(),U.Vb(5,"td"),U.Vb(6,"button",25),U.dc("click",(function(){U.uc(t);const e=o.i;return U.hc().options.splice(e,1)})),U.Vb(7,"mat-icon"),U.Bc(8," remove "),U.Ub(),U.Ub(),U.Ub(),U.Ub()}if(2&t){const t=o.$implicit;U.Cb(2),U.oc("ngModel",t.title)("ngModelOptions",U.pc(4,W)),U.Cb(2),U.oc("ngModel",t.price)("ngModelOptions",U.pc(5,W))}}function Z(t,o){1&t&&(U.Vb(0,"mat-error"),U.Bc(1," You need at least one option! "),U.Ub())}const H=[{path:"",component:j},{path:"editor",component:(()=>{class t{constructor(t,o,e,n,i){this.route=t,this.toast=o,this.history=e,this.service=n,this.formerror=i,this.form=new N.e({icon:new N.b(null,[N.s.required]),phone:new N.b(null,[N.s.required]),email:new N.b(null,[N.s.required,N.s.email]),account:new N.b(null,[N.s.required]),description:new N.b(null,[N.s.required]),organizationOnly:new N.b(1,[N.s.required])}),this.errors={icon:"",phone:"",email:"",account:"",description:"",organizationOnly:""},this.options=[],this.optionItem={},this.subscriptions={}}get(){return Object(I.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.get({filter:["icon","role","phone","email","storeId","options","account","courierId","description","organizationOnly"],storeId:this.storeId,courierId:this.courierId});t.ok?(t.result.role<3&&this.history.back(),this.options=t.result.options,this.form.controls.icon.setValue(t.result.icon),this.form.controls.phone.setValue(t.result.phone),this.form.controls.email.setValue(t.result.email),this.form.controls.account.setValue(t.result.account),this.form.controls.description.setValue(t.result.description),this.form.controls.organizationOnly.setValue(t.result.organizationOnly)):this.toast.error(t.error.message),this.loading=!1}))}submit(){return Object(I.a)(this,void 0,void 0,(function*(){this.loading=!0;let t=this.mode;"copy"==t&&(t="add",delete this.courierId);const o=yield this.service[t]({icon:this.form.value.icon,phone:this.form.value.phone,email:this.form.value.email,account:this.form.value.account,options:this.options,storeId:this.storeId,courierId:this.courierId,description:this.form.value.description,organizationOnly:this.form.value.organizationOnly});o.ok?(this.toast.success("courier was updated!"),this.history.back()):this.toast.error(o.error.message),this.loading=!1}))}AddOption(){return Object(I.a)(this,void 0,void 0,(function*(){this.optionItem.optionId=((new Date).getTime()/1e3|0).toString(16)+"xxxxxxxxxxxxxxxx".replace(/[x]/g,()=>(16*Math.random()|0).toString(16)).toLowerCase(),this.options.push(this.optionItem),this.optionItem={}}))}ngOnInit(){this.subscriptions.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.subscriptions.route=this.route.queryParams.subscribe(t=>Object(I.a)(this,void 0,void 0,(function*(){this.mode=t.mode,this.storeId=t.storeId,this.courierId=t.courierId,"add"!=this.mode&&(yield this.get())}))),this.subscriptions.upload=this.upload.result.subscribe(t=>{this.form.controls.icon.setValue(t)})}ngOnDestroy(){this.subscriptions.form.unsubscribe(),this.subscriptions.route.unsubscribe(),this.subscriptions.upload.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(U.Pb(B.a),U.Pb(k.a),U.Pb(G.a),U.Pb(q.a),U.Pb(K.a))},t.\u0275cmp=U.Jb({type:t,selectors:[["app-courier-editor-page"]],viewQuery:function(t,o){var e;1&t&&U.yc(F.a,!0),2&t&&U.rc(e=U.ec())&&(o.upload=e.first)},decls:58,vars:23,consts:[["color","primary"],["mat-icon-button","",1,"menu-toggle",3,"click"],[1,"page-title","spacer"],["mode","indeterminate",4,"ngIf"],[1,"page-body"],[3,"formGroup","ngSubmit"],["accept","image/*",3,"file","required","disabled"],["appearance","outline"],["text-uppercase",""],["matInput","","type","text","placeholder","description","formControlName","description","required",""],[4,"ngIf"],["matInput","","type","text","placeholder","account","formControlName","account","required",""],["name","organizationOnly","placeholder","Sharing Rules","formControlName","organizationOnly","required",""],[3,"value"],["matInput","","type","tel","placeholder","phone","formControlName","phone","required",""],["matInput","","type","email","placeholder","email","formControlName","email","required",""],[1,"options"],[4,"ngFor","ngForOf"],["matInput","","type","title","name","text","placeholder","option title",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","number","min","0","name","text","placeholder","option price",3,"ngModel","ngModelOptions","ngModelChange"],["type","button","mat-icon-button","",3,"disabled","click"],["type","submit","mat-flat-button","","color","primary"],["mode","indeterminate"],["matInput","","type","title","name","text","placeholder","option title","required","",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","number","min","0","name","text","placeholder","option price","required","",3,"ngModel","ngModelOptions","ngModelChange"],["type","button","mat-icon-button","","color","warn",3,"click"]],template:function(t,o){1&t&&(U.Vb(0,"mat-toolbar",0),U.Vb(1,"button",1),U.dc("click",(function(){return o.history.back()})),U.Vb(2,"mat-icon"),U.Bc(3," arrow_back "),U.Ub(),U.Ub(),U.Vb(4,"label",2),U.Bc(5," courier editor "),U.Ub(),U.Ub(),U.Ac(6,R,1,0,"mat-progress-bar",3),U.Vb(7,"div",4),U.Vb(8,"form",5),U.dc("ngSubmit",(function(){return!o.form.invalid&&o.options.length>0&&!o.loading&&o.submit()})),U.Qb(9,"app-file-upload",6),U.Vb(10,"mat-form-field",7),U.Vb(11,"mat-label",8),U.Bc(12," description "),U.Ub(),U.Qb(13,"input",9),U.Ac(14,T,2,1,"mat-error",10),U.Ub(),U.Vb(15,"mat-form-field",7),U.Vb(16,"mat-label",8),U.Bc(17," account "),U.Ub(),U.Qb(18,"input",11),U.Ac(19,$,2,1,"mat-error",10),U.Ub(),U.Vb(20,"mat-form-field",7),U.Vb(21,"mat-label",8),U.Bc(22," Sharing Rules "),U.Ub(),U.Vb(23,"mat-select",12),U.Vb(24,"mat-option",13),U.Bc(25," Share To Anyone "),U.Ub(),U.Vb(26,"mat-option",13),U.Bc(27," Share In Organization "),U.Ub(),U.Ub(),U.Ac(28,E,2,1,"mat-error",10),U.Ub(),U.Vb(29,"h2"),U.Bc(30," contact "),U.Ub(),U.Vb(31,"mat-form-field",7),U.Vb(32,"mat-label",8),U.Bc(33," phone "),U.Ub(),U.Qb(34,"input",14),U.Ac(35,J,2,1,"mat-error",10),U.Ub(),U.Vb(36,"mat-form-field",7),U.Vb(37,"mat-label",8),U.Bc(38," email "),U.Ub(),U.Qb(39,"input",15),U.Ac(40,L,2,1,"mat-error",10),U.Ub(),U.Vb(41,"div",16),U.Vb(42,"label"),U.Bc(43," delivery options * "),U.Ub(),U.Vb(44,"table"),U.Ac(45,X,9,6,"tr",17),U.Vb(46,"tr"),U.Vb(47,"th"),U.Vb(48,"input",18),U.dc("ngModelChange",(function(t){return o.optionItem.title=t})),U.Ub(),U.Ub(),U.Vb(49,"td"),U.Vb(50,"input",19),U.dc("ngModelChange",(function(t){return o.optionItem.price=t})),U.Ub(),U.Ub(),U.Vb(51,"td"),U.Vb(52,"button",20),U.dc("click",(function(){return o.AddOption()})),U.Vb(53,"mat-icon"),U.Bc(54," add "),U.Ub(),U.Ub(),U.Ub(),U.Ub(),U.Ub(),U.Ac(55,Z,2,0,"mat-error",10),U.Ub(),U.Vb(56,"button",21),U.Bc(57," submit "),U.Ub(),U.Ub(),U.Ub()),2&t&&(U.Cb(6),U.oc("ngIf",o.loading),U.Cb(2),U.oc("formGroup",o.form),U.Cb(1),U.oc("file",o.form.value.icon)("required",!0)("disabled",o.loading),U.Cb(5),U.oc("ngIf",o.errors.description),U.Cb(5),U.oc("ngIf",o.errors.account),U.Cb(5),U.oc("value",0),U.Cb(2),U.oc("value",1),U.Cb(2),U.oc("ngIf",o.errors.organizationOnly),U.Cb(7),U.oc("ngIf",o.errors.phone),U.Cb(5),U.oc("ngIf",o.errors.email),U.Cb(1),U.Fb("error",0==o.options.length),U.Cb(4),U.oc("ngForOf",o.options),U.Cb(3),U.oc("ngModel",o.optionItem.title)("ngModelOptions",U.pc(21,W)),U.Cb(2),U.oc("ngModel",o.optionItem.price)("ngModelOptions",U.pc(22,W)),U.Cb(2),U.oc("disabled",!o.optionItem.title||!o.optionItem.price),U.Cb(3),U.oc("ngIf",0==o.options.length))},directives:[g.a,p.a,d.a,a.m,N.t,N.m,N.f,F.a,C.c,C.g,b.b,N.a,N.l,N.d,N.r,m.a,h.n,a.l,N.o,N.p,O.a,C.b],styles:["form[_ngcontent-%COMP%]{width:400px}form[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   app-file-upload[_ngcontent-%COMP%]{margin:10px auto}form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px;line-height:14px;margin:0 0 5px;text-transform:uppercase}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{border:1px solid #e0e0e0;padding:5px;position:relative;margin-top:2px;margin-bottom:25px;border-radius:4px}form[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{top:-4px;left:4px;padding:0 4px;position:absolute;font-size:10px;line-height:10px;text-transform:uppercase;background-color:#fafafa}form[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{text-align:left;border-radius:4px}form[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:12px;line-height:12px;border-bottom:1px solid #e0e0e0}form[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-transform:uppercase}form[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   th[_ngcontent-%COMP%]{border-bottom:none}form[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   mat-error[_ngcontent-%COMP%]{left:10px;bottom:-20px;position:absolute;font-size:11px;line-height:11px}form[_ngcontent-%COMP%]   .options.error[_ngcontent-%COMP%]{border:2px solid red;margin-top:1px}@media screen and (max-width:420px){form[_ngcontent-%COMP%]{width:calc(100% - 20px);margin:10px}}"]}),t})()}];let Y=(()=>{class t{}return t.\u0275mod=U.Nb({type:t}),t.\u0275inj=U.Mb({factory:function(o){return new(o||t)},imports:[[B.g.forChild(H)],B.g]}),t})();var tt=e("Q92/");let ot=(()=>{class t{}return t.\u0275mod=U.Nb({type:t}),t.\u0275inj=U.Mb({factory:function(o){return new(o||t)},imports:[[i.a,n.a,N.h,r.a,s.a,c.a,a.c,d.b,l.c,b.c,m.b,u.c,p.b,h.s,g.b,tt.a,C.e,f.a,N.q,M.c,O.b,Y]]}),t})()}}]);