(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"9gde":function(e,t,r){"use strict";r.r(t),r.d(t,"SuppliersModule",(function(){return ee}));var s=r("ojfV"),o=r("2xuv"),i=r("+PXZ"),n=r("3lET"),a=r("CSBE"),c=r("ofXK"),l=r("MutI"),d=r("NFeN"),b=r("qFsG"),u=r("0IaG"),p=r("FKr1"),m=r("d3UM"),h=r("bTqV"),f=r("/t3+"),g=r("Q92/"),y=r("kmnG"),I=r("NwyA"),C=r("bv9b"),V=r("2ChS"),v=r("mrSG"),U=r("+bmA"),w=r("KK9o"),O=r("IQQo"),P=r("HqD8"),B=r("nFDT"),k=r("jDep"),q=r("fXoL"),x=r("d3yR"),D=r("9ZKQ"),M=r("ZVi7"),N=r("tyNb"),Q=r("wPrS"),z=r("sC6t");function A(e,t){1&e&&q.Qb(0,"mat-progress-bar",8)}function T(e,t){if(1&e){const e=q.Wb();q.Vb(0,"mat-list-item",9),q.dc("click",(function(){q.uc(e);const r=t.$implicit;return q.hc().options(r)})),q.Vb(1,"h3"),q.Bc(2),q.Ub(),q.Ub()}if(2&e){const e=t.$implicit;q.Cb(2),q.Dc(" ",e.description," ")}}const _=function(e){return{mode:"add",storeId:e}};let S=(()=>{class e{constructor(e,t,r,s,o,i,n){this.menu=e,this.toast=t,this.sheet=r,this.dialog=s,this.suppliers=o,this.route=i,this.router=n,this.filter="",this.subscriptions={}}list(){return Object(v.a)(this,void 0,void 0,(function*(){this.loading=!0;const e=yield this.suppliers.list({filter:["role","icon","storeId","supplierId","description"],storeId:this.storeId});this.suppliers.data=e.ok?e.result:[],this.loading=!1}))}options(e){return Object(v.a)(this,void 0,void 0,(function*(){const t=yield this.sheet.open(k.a,{data:{items:[{role:e.role,icon:"edit",scope:3,title:"Edit",option:1},{role:e.role,icon:"file_copy",scope:3,title:"Copy",option:2},{role:e.role,icon:"share",scope:4,title:"Share",option:3},{role:e.role,icon:"people",scope:4,title:"Subscribers",option:4},{role:e.role,icon:"remove",scope:1,color:"warn",title:"Unsubscribe",option:5},{role:e.role,icon:"delete",scope:5,color:"warn",title:"Delete",option:6}],title:e.description}});yield t.afterDismissed().subscribe(t=>Object(v.a)(this,void 0,void 0,(function*(){if(t)switch(t){case 1:this.router.navigate(["/suppliers","editor"],{queryParams:{mode:"update",storeId:this.storeId,supplierId:e.supplierId}});break;case 2:this.router.navigate(["/suppliers","editor"],{queryParams:{mode:"copy",storeId:this.storeId,supplierId:e.supplierId}});break;case 3:const t=yield this.dialog.open(U.a,{panelClass:"share-dialog"});yield t.afterClosed().subscribe(t=>Object(v.a)(this,void 0,void 0,(function*(){if(t){this.loading=!0;const r=yield this.suppliers.share({role:t.role,email:t.email,storeId:this.storeId,supplierId:e.supplierId});r.ok?this.toast.success("user was shared!"):this.toast.error(r.error.message),this.loading=!1}})));break;case 4:this.dialog.open(B.a,{data:{id:e.supplierId,type:"supplier",storeId:this.storeId,service:this.suppliers},panelClass:"subscribers-dialog"});break;case 5:const r=yield this.dialog.open(P.a,{panelClass:"unsubscribe-dialog"});yield r.afterClosed().subscribe(t=>Object(v.a)(this,void 0,void 0,(function*(){if(t){this.loading=!0;const t=yield this.suppliers.unsubscribe({storeId:this.storeId,supplierId:e.supplierId});t.ok?this.toast.success("you were unsubscribed from supplier!"):this.toast.error(t.error.message),this.loading=!1}})));break;case 6:const s=yield this.dialog.open(w.a,{panelClass:"delete-dialog"});yield s.afterClosed().subscribe(t=>Object(v.a)(this,void 0,void 0,(function*(){if(t){this.loading=!0;const t=yield this.suppliers.delete({storeId:this.storeId,supplierId:e.supplierId});t.ok?this.toast.success("supplier was deleted!"):this.toast.error(t.error.message),this.loading=!1}})))}})))}))}ngOnInit(){this.subscriptions.route=this.route.queryParams.subscribe(e=>{void 0!==e.storeId&&null!=e.storeId&&""!=e.storeId?(this.storeId=e.storeId,this.list()):this.router.navigate(["/stores"])}),this.subscriptions.search=this.search.change.subscribe(e=>{this.filter=e})}ngOnDestroy(){this.subscriptions.route.unsubscribe(),this.subscriptions.search.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(q.Pb(x.a),q.Pb(D.a),q.Pb(V.b),q.Pb(u.b),q.Pb(M.a),q.Pb(N.a),q.Pb(N.c))},e.\u0275cmp=q.Jb({type:e,selectors:[["app-suppliers-page"]],viewQuery:function(e,t){var r;1&e&&q.yc(O.a,!0),2&e&&q.rc(r=q.ec())&&(t.search=r.first)},decls:16,vars:12,consts:[["color","primary"],["mat-icon-button","",1,"menu-toggle",3,"click"],[1,"page-title","spacer"],["placeholder","search suppliers"],["mat-icon-button","","routerLink","editor",3,"queryParams"],["mode","indeterminate",4,"ngIf"],[1,"page-body"],["matRipple","",3,"click",4,"ngFor","ngForOf"],["mode","indeterminate"],["matRipple","",3,"click"]],template:function(e,t){1&e&&(q.Vb(0,"mat-toolbar",0),q.Vb(1,"button",1),q.dc("click",(function(){return t.menu.toggle()})),q.Vb(2,"mat-icon"),q.Bc(3," menu "),q.Ub(),q.Ub(),q.Vb(4,"label",2),q.Bc(5," suppliers "),q.Ub(),q.Qb(6,"search",3),q.Vb(7,"button",4),q.Vb(8,"mat-icon"),q.Bc(9," add "),q.Ub(),q.Ub(),q.Ub(),q.Ac(10,A,1,0,"mat-progress-bar",5),q.Vb(11,"div",6),q.Vb(12,"mat-list"),q.Ac(13,T,3,1,"mat-list-item",7),q.ic(14,"filterBy"),q.ic(15,"orderBy"),q.Ub(),q.Ub()),2&e&&(q.Cb(7),q.oc("queryParams",q.qc(10,_,t.storeId)),q.Cb(3),q.oc("ngIf",t.loading),q.Cb(3),q.oc("ngForOf",q.lc(14,3,q.kc(15,7,t.suppliers.data,"description"),"description",t.filter)))},directives:[f.a,h.a,d.a,O.a,N.d,c.m,l.a,c.l,C.a,l.b,p.r],pipes:[Q.a,z.a],styles:["mat-list[_ngcontent-%COMP%]{padding:0!important}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{flex:1 auto;cursor:pointer;display:flex;align-items:center;border-bottom:1px solid #e0e0e0;flex-direction:row}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:14px;line-height:14px;text-transform:uppercase}"]}),e})();var j=r("3Pt+"),F=r("5mtf"),G=r("dWDE");function K(e,t){1&e&&q.Qb(0,"mat-progress-bar",20)}function R(e,t){if(1&e&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&e){const e=q.hc();q.Cb(1),q.Dc(" ",e.errors.description," ")}}function E(e,t){if(1&e&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&e){const e=q.hc();q.Cb(1),q.Dc(" ",e.errors.organizationOnly," ")}}function J(e,t){if(1&e&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&e){const e=q.hc();q.Cb(1),q.Dc(" ",e.errors.address.street," ")}}function X(e,t){if(1&e&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&e){const e=q.hc();q.Cb(1),q.Dc(" ",e.errors.address.suburb," ")}}function Z(e,t){if(1&e&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&e){const e=q.hc();q.Cb(1),q.Dc(" ",e.errors.address.cityTown," ")}}function L(e,t){if(1&e&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&e){const e=q.hc();q.Cb(1),q.Dc(" ",e.errors.address.postalCode," ")}}function W(e,t){if(1&e&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&e){const e=q.hc();q.Cb(1),q.Dc(" ",e.errors.email," ")}}function $(e,t){if(1&e&&(q.Vb(0,"mat-error"),q.Bc(1),q.Ub()),2&e){const e=q.hc();q.Cb(1),q.Dc(" ",e.errors.phone," ")}}const H=[{path:"",component:S},{path:"editor",component:(()=>{class e{constructor(e,t,r,s,o){this.route=e,this.toast=t,this.service=r,this.history=s,this.formerror=o,this.form=new j.e({address:new j.e({street:new j.b("",[j.s.required]),suburb:new j.b("",[j.s.required]),cityTown:new j.b("",[j.s.required]),postalCode:new j.b("",[j.s.required])}),phone:new j.b("",[j.s.required]),email:new j.b("",[j.s.required,j.s.email]),description:new j.b("",[j.s.required]),organizationOnly:new j.b(1,[j.s.required])}),this.errors={address:{street:"",suburb:"",cityTown:"",postalCode:""},phone:"",email:"",description:"",organizationOnly:""},this.subscriptions={}}get(){return Object(v.a)(this,void 0,void 0,(function*(){this.loading=!0;const e=yield this.service.get({filter:["role","phone","email","address","description","organizationOnly"],storeId:this.storeId,supplierId:this.supplierId});if(e.ok){e.result.role<3&&this.history.back();const t=this.form.controls.address;t.controls.street.setValue(e.result.address.street),t.controls.suburb.setValue(e.result.address.suburb),t.controls.cityTown.setValue(e.result.address.cityTown),t.controls.postalCode.setValue(e.result.address.postalCode),this.form.controls.phone.setValue(e.result.phone),this.form.controls.email.setValue(e.result.email),this.form.controls.description.setValue(e.result.description),this.form.controls.organizationOnly.setValue(e.result.organizationOnly)}else this.toast.error(e.error.message);this.loading=!1}))}submit(){return Object(v.a)(this,void 0,void 0,(function*(){this.loading=!0;let e=this.mode;"copy"==e&&(e="add",delete this.supplierId);const t=yield this.service[e]({phone:this.form.value.phone,email:this.form.value.email,address:this.form.value.address,storeId:this.storeId,supplierId:this.supplierId,description:this.form.value.description,organizationOnly:this.form.value.organizationOnly});t.ok?(this.toast.success("supplier was updated!"),this.history.back()):this.toast.error(t.error.message),this.loading=!1}))}ngOnInit(){this.subscriptions.form=this.form.valueChanges.subscribe(e=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.subscriptions.route=this.route.queryParams.subscribe(e=>{this.mode=e.mode,this.storeId=e.storeId,this.supplierId=e.supplierId,"add"!=this.mode&&this.get()})}ngOnDestroy(){this.subscriptions.form.unsubscribe(),this.subscriptions.route.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(q.Pb(N.a),q.Pb(D.a),q.Pb(M.a),q.Pb(F.a),q.Pb(G.a))},e.\u0275cmp=q.Jb({type:e,selectors:[["app-supplier-editor-page"]],decls:60,vars:12,consts:[["color","primary"],["mat-icon-button","",1,"menu-toggle",3,"click"],[1,"page-title","spacer"],["mode","indeterminate",4,"ngIf"],[1,"page-body"],[3,"formGroup","ngSubmit"],["appearance","outline"],["text-uppercase",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],[4,"ngIf"],["name","organizationOnly","placeholder","Sharing Rules","formControlName","organizationOnly","required",""],[3,"value"],["formGroupName","address"],["matInput","","type","text","name","street","placeholder","street","formControlName","street","required",""],["matInput","","type","text","name","suburb","placeholder","suburb","formControlName","suburb","required",""],["matInput","","type","text","name","cityTown","placeholder","City/Town","formControlName","cityTown","required",""],["matInput","","type","text","name","postalCode","placeholder","Postal Code","formControlName","postalCode","required",""],["matInput","","type","email","name","email","placeholder","email","formControlName","email","required",""],["matInput","","type","tel","name","phone","placeholder","phone","formControlName","phone","required",""],["type","submit","mat-flat-button","","color","primary"],["mode","indeterminate"]],template:function(e,t){1&e&&(q.Vb(0,"mat-toolbar",0),q.Vb(1,"button",1),q.dc("click",(function(){return t.history.back()})),q.Vb(2,"mat-icon"),q.Bc(3," arrow_back "),q.Ub(),q.Ub(),q.Vb(4,"label",2),q.Bc(5," supplier editor "),q.Ub(),q.Ub(),q.Ac(6,K,1,0,"mat-progress-bar",3),q.Vb(7,"div",4),q.Vb(8,"form",5),q.dc("ngSubmit",(function(){return!t.form.invalid&&!t.loading&&t.submit()})),q.Vb(9,"mat-form-field",6),q.Vb(10,"mat-label",7),q.Bc(11," description "),q.Ub(),q.Qb(12,"input",8),q.Ac(13,R,2,1,"mat-error",9),q.Ub(),q.Vb(14,"mat-form-field",6),q.Vb(15,"mat-label",7),q.Bc(16," Sharing Rules "),q.Ub(),q.Vb(17,"mat-select",10),q.Vb(18,"mat-option",11),q.Bc(19," Share To Anyone "),q.Ub(),q.Vb(20,"mat-option",11),q.Bc(21," Share In Organization "),q.Ub(),q.Ub(),q.Ac(22,E,2,1,"mat-error",9),q.Ub(),q.Vb(23,"h2"),q.Bc(24," address "),q.Ub(),q.Vb(25,"div",12),q.Vb(26,"mat-form-field",6),q.Vb(27,"mat-label",7),q.Bc(28," street "),q.Ub(),q.Qb(29,"input",13),q.Ac(30,J,2,1,"mat-error",9),q.Ub(),q.Vb(31,"mat-form-field",6),q.Vb(32,"mat-label",7),q.Bc(33," suburb "),q.Ub(),q.Qb(34,"input",14),q.Ac(35,X,2,1,"mat-error",9),q.Ub(),q.Vb(36,"mat-form-field",6),q.Vb(37,"mat-label",7),q.Bc(38," City/Town "),q.Ub(),q.Qb(39,"input",15),q.Ac(40,Z,2,1,"mat-error",9),q.Ub(),q.Vb(41,"mat-form-field",6),q.Vb(42,"mat-label",7),q.Bc(43," Postal Code "),q.Ub(),q.Qb(44,"input",16),q.Ac(45,L,2,1,"mat-error",9),q.Ub(),q.Ub(),q.Vb(46,"h2"),q.Bc(47," contact "),q.Ub(),q.Vb(48,"mat-form-field",6),q.Vb(49,"mat-label",7),q.Bc(50," email "),q.Ub(),q.Qb(51,"input",17),q.Ac(52,W,2,1,"mat-error",9),q.Ub(),q.Vb(53,"mat-form-field",6),q.Vb(54,"mat-label",7),q.Bc(55," phone "),q.Ub(),q.Qb(56,"input",18),q.Ac(57,$,2,1,"mat-error",9),q.Ub(),q.Vb(58,"button",19),q.Bc(59," submit "),q.Ub(),q.Ub(),q.Ub()),2&e&&(q.Cb(6),q.oc("ngIf",t.loading),q.Cb(2),q.oc("formGroup",t.form),q.Cb(5),q.oc("ngIf",t.errors.description),q.Cb(5),q.oc("value",0),q.Cb(2),q.oc("value",1),q.Cb(2),q.oc("ngIf",t.errors.organizationOnly),q.Cb(8),q.oc("ngIf",t.errors.address.street),q.Cb(5),q.oc("ngIf",t.errors.address.suburb),q.Cb(5),q.oc("ngIf",t.errors.address.cityTown),q.Cb(5),q.oc("ngIf",t.errors.address.postalCode),q.Cb(7),q.oc("ngIf",t.errors.email),q.Cb(5),q.oc("ngIf",t.errors.phone))},directives:[f.a,h.a,d.a,c.m,j.t,j.m,j.f,y.c,y.g,b.b,j.a,j.l,j.d,j.r,m.a,p.n,j.g,C.a,y.b],styles:["form[_ngcontent-%COMP%]{width:400px;margin:10px auto}form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px;line-height:14px;margin:0 0 5px;text-transform:uppercase}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}@media screen and (max-width:420px){form[_ngcontent-%COMP%]{width:calc(100% - 20px);margin:10px}}"]}),e})()}];let Y=(()=>{class e{}return e.\u0275mod=q.Nb({type:e}),e.\u0275inj=q.Mb({factory:function(t){return new(t||e)},imports:[[N.g.forChild(H)],N.g]}),e})(),ee=(()=>{class e{}return e.\u0275mod=q.Nb({type:e}),e.\u0275inj=q.Mb({factory:function(t){return new(t||e)},imports:[[s.a,o.a,j.h,i.a,n.a,a.a,c.c,d.b,l.c,b.c,m.b,u.c,h.b,p.s,f.b,g.a,y.e,I.a,j.q,V.c,C.b,Y]]}),e})()}}]);